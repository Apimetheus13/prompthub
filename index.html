<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PromptHub - AI Prompt 管理平台</title>
    
    <!-- PWA Meta tags -->
    <meta name="description" content="專業的 AI Prompt 管理平台，支援雲端同步、社群分享">
    <meta name="theme-color" content="#667eea">
    <link rel="manifest" href="data:application/json;base64,ewogICJuYW1lIjogIlByb21wdEh1YiAtIEFJIFByb21wdCDnrqHnkIblubPlj7AiLAogICJzaG9ydF9uYW1lIjogIlByb21wdEh1YiIsCiAgImRlc2NyaXB0aW9uIjogIuWwiualreaWh+eahCBBSSBQcm9tcHQg566h55CG5bmz5Y+wIiwKICAiaWNvbnMiOiBbCiAgICB7CiAgICAgICJzcmMiOiAiZGF0YTppbWFnZS9zdmcreG1sO2Jhc2U2NCxQSE4yWnlCM2FXUjBhRDBpTVRJNElpQm9aV2xuYUhROUlqRXlPQ0lpSUdacGJHdzlJaU01TmpkbFpXRWlJSGh0Ykc1elBTSm9kSFJ3T2k4dmQzZDNMbmN6TG05eVp5OHlNREF3TDNOMlp5SStQSEpsWTNRZ2VEMGlNalFpSUhrOUlqSTBJaUIzYVdSMGFEMGlPREFpSUdobGFXZG9kRDBpT0RBaUlHWnBiR3c5SWk5bU5qa3JJaTgrUEhSbGVIUWdlRDBpTmpRaUlIazlJall3SWlCbWFXeHNQU0oxYUdsdFpTSWdabTl1ZEMxemFYcGxQU0l4TkNJK1VISnZiWEIwUEM5MFpYaDBQand2YzNabktnPT0iLAogICAgICAic2l6ZXMiOiAiMTI4eDEyOCIsCiAgICAgICJ0eXBlIjogImltYWdlL3N2Zyt4bWwiCiAgICB9CiAgXSwKICAic3RhcnRfdXJsIjogIi4vIiwKICAiZGlzcGxheSI6ICJzdGFuZGFsb25lIiwKICAiYmFja2dyb3VuZF9jb2xvciI6ICIjZjhmOWZhIiwKICAidGhlbWVfY29sb3IiOiAiIzY2N2VlYSIKfQ==">
    <link rel="apple-touch-icon" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTI4IiBoZWlnaHQ9IjEyOCIgZmlsbD0iIzY2N2VlYSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB4PSIyNCIgeT0iMjQiIHdpZHRoPSI4MCIgaGVpZ2h0PSI4MCIgZmlsbD0iIzY2OWUrIi8+PHRleHQgeD0iNjQiIHk9IjYwIiBmaWxsPSJ3aGl0ZSIgZm9udC1zaXplPSIxNCI+UHJvbXB0PC90ZXh0Pjwvc3ZnPg==">

    <style>
        :root {
            --primary-color: #667eea;
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --secondary-color: #f8f9fa;
            --text-color: #333;
            --border-color: #e9ecef;
            --shadow-light: 0 2px 10px rgba(0,0,0,0.08);
            --shadow-medium: 0 4px 20px rgba(0,0,0,0.15);
            --border-radius: 12px;
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: var(--secondary-color);
            color: var(--text-color);
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* Header Styles */
        .header {
            background: var(--primary-gradient);
            color: white;
            padding: 1rem;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: var(--shadow-medium);
            backdrop-filter: blur(10px);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1200px;
            margin: 0 auto;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .user-status {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
        }

        .sync-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #4caf50;
            animation: pulse 2s infinite;
        }

        .sync-indicator.syncing {
            background: #ff9800;
        }

        .sync-indicator.offline {
            background: #f44336;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        /* Button Styles */
        .btn {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-family: inherit;
        }

        .btn-primary {
            background: rgba(255,255,255,0.2);
            color: white;
            backdrop-filter: blur(10px);
        }

        .btn-primary:hover {
            background: rgba(255,255,255,0.3);
            transform: translateY(-1px);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-success {
            background: #28a745;
            color: white;
        }

        .btn-danger {
            background: #dc3545;
            color: white;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-medium);
        }

        /* Container and Layout */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 1rem;
        }

        .main-content {
            min-height: calc(100vh - 200px);
        }

        /* Search and Filter Styles */
        .search-section {
            background: white;
            border-radius: var(--border-radius);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: var(--shadow-light);
            position: sticky;
            top: 80px;
            z-index: 50;
        }

        .search-input {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            font-size: 1rem;
            transition: var(--transition);
            background: rgba(255,255,255,0.9);
        }

        .search-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .filters {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
            flex-wrap: wrap;
        }

        .filter-tag {
            padding: 0.4rem 1rem;
            background: var(--border-color);
            border: none;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: var(--transition);
            font-family: inherit;
        }

        .filter-tag.active {
            background: var(--primary-color);
            color: white;
        }

        .filter-tag:hover {
            transform: translateY(-1px);
        }

        /* Content Grid */
        .content-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        /* Prompt Card Styles */
        .prompt-card {
            background: white;
            border-radius: var(--border-radius);
            padding: 1.5rem;
            box-shadow: var(--shadow-light);
            transition: var(--transition);
            border: 2px solid transparent;
            position: relative;
            overflow: hidden;
        }

        .prompt-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--primary-gradient);
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }

        .prompt-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-medium);
            border-color: var(--primary-color);
        }

        .prompt-card:hover::before {
            transform: scaleX(1);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }

        .card-title {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--text-color);
            margin-bottom: 0.5rem;
            line-height: 1.3;
        }

        .card-meta {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
            margin-bottom: 0.5rem;
        }

        .meta-tag {
            padding: 0.2rem 0.6rem;
            border-radius: 15px;
            font-size: 0.7rem;
            font-weight: 500;
        }

        .meta-public {
            background: #e3f2fd;
            color: #1976d2;
        }

        .meta-private {
            background: #fff3e0;
            color: #f57c00;
        }

        .meta-premium {
            background: linear-gradient(45deg, #ffd700, #ffed4e);
            color: #b8860b;
        }

        .card-author {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.8rem;
            color: #666;
        }

        .author-avatar {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: var(--primary-gradient);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            font-weight: bold;
        }

        .card-content {
            margin: 1rem 0;
        }

        .prompt-preview {
            background: #f8f9fa;
            padding: 1rem;
            border-radius: 8px;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 0.85rem;
            border-left: 4px solid var(--primary-color);
            margin-bottom: 1rem;
            max-height: 150px;
            overflow: hidden;
            position: relative;
            line-height: 1.5;
        }

        .prompt-preview::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 30px;
            background: linear-gradient(transparent, #f8f9fa);
            pointer-events: none;
        }

        .card-description {
            color: #666;
            font-size: 0.9rem;
            margin-bottom: 1rem;
            line-height: 1.5;
        }

        .card-tags {
            display: flex;
            gap: 0.3rem;
            flex-wrap: wrap;
            margin-bottom: 1rem;
        }

        .tag {
            padding: 0.2rem 0.6rem;
            background: var(--border-color);
            border-radius: 12px;
            font-size: 0.7rem;
            color: #666;
            transition: var(--transition);
        }

        .tag:hover {
            background: var(--primary-color);
            color: white;
            cursor: pointer;
        }

        .card-stats {
            display: flex;
            gap: 1rem;
            margin: 1rem 0;
            padding: 0.5rem 0;
            border-top: 1px solid var(--border-color);
            font-size: 0.8rem;
            color: #666;
        }

        .stat-item {
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .card-actions {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid var(--border-color);
        }

        .action-left {
            display: flex;
            gap: 0.5rem;
        }

        .action-right {
            display: flex;
            gap: 0.5rem;
        }

        .action-btn {
            display: flex;
            align-items: center;
            gap: 0.3rem;
            background: none;
            border: none;
            color: #666;
            cursor: pointer;
            font-size: 0.8rem;
            padding: 0.4rem 0.6rem;
            border-radius: 6px;
            transition: var(--transition);
            font-family: inherit;
        }

        .action-btn:hover {
            color: var(--primary-color);
            background: rgba(102, 126, 234, 0.1);
            transform: translateY(-1px);
        }

        .action-btn.liked {
            color: #e74c3c;
        }

        .action-btn.bookmarked {
            color: #f39c12;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            backdrop-filter: blur(5px);
            z-index: 1000;
            animation: fadeIn 0.3s ease;
        }

        .modal.show {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content {
            background: white;
            border-radius: var(--border-radius);
            padding: 2rem;
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            animation: slideUp 0.3s ease;
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
        }

        @keyframes slideUp {
            from { 
                opacity: 0; 
                transform: translateY(50px); 
            }
            to { 
                opacity: 1; 
                transform: translateY(0); 
            }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid var(--border-color);
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--text-color);
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #999;
            padding: 0.25rem;
            border-radius: 4px;
            transition: var(--transition);
        }

        .close-btn:hover {
            color: var(--text-color);
            background: var(--border-color);
        }

        /* Form Styles */
        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: var(--text-color);
        }

        .form-input, .form-textarea, .form-select {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            font-size: 1rem;
            transition: var(--transition);
            font-family: inherit;
            background: white;
        }

        .form-textarea {
            min-height: 200px;
            resize: vertical;
            font-family: 'Monaco', 'Menlo', monospace;
            line-height: 1.5;
        }

        .form-input:focus, .form-textarea:focus, .form-select:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .form-checkbox-group {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .form-checkbox {
            width: auto;
            margin: 0;
        }

        .form-actions {
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
            margin-top: 2rem;
            padding-top: 1rem;
            border-top: 2px solid var(--border-color);
        }

        /* Floating Action Button */
        .fab {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            width: 64px;
            height: 64px;
            background: var(--primary-gradient);
            border: none;
            border-radius: 50%;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 0 8px 24px rgba(102, 126, 234, 0.4);
            transition: var(--transition);
            z-index: 50;
        }

        .fab:hover {
            transform: scale(1.1) translateY(-2px);
            box-shadow: 0 12px 32px rgba(102, 126, 234, 0.6);
        }

        .fab:active {
            transform: scale(0.95);
        }

        /* Bottom Navigation */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(10px);
            border-top: 1px solid var(--border-color);
            padding: 0.5rem;
            display: flex;
            justify-content: space-around;
            z-index: 100;
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 0.5rem;
            color: #666;
            text-decoration: none;
            font-size: 0.7rem;
            transition: var(--transition);
            border-radius: 8px;
            position: relative;
        }

        .nav-item.active {
            color: var(--primary-color);
            background: rgba(102, 126, 234, 0.1);
        }

        .nav-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 2px;
            background: var(--primary-color);
            transition: width 0.3s ease;
        }

        .nav-item.active::before {
            width: 24px;
        }

        .nav-icon {
            font-size: 1.2rem;
            margin-bottom: 0.2rem;
        }

        /* Notification Styles */
        .notification {
            position: fixed;
            top: 2rem;
            right: 2rem;
            background: var(--primary-gradient);
            color: white;
            padding: 1rem 1.5rem;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-medium);
            transform: translateX(400px);
            transition: transform 0.3s ease;
            z-index: 1100;
            max-width: 300px;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.success {
            background: linear-gradient(135deg, #4caf50, #45a049);
        }

        .notification.error {
            background: linear-gradient(135deg, #f44336, #d32f2f);
        }

        .notification.warning {
            background: linear-gradient(135deg, #ff9800, #f57c00);
        }

        /* Loading States */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .skeleton {
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
        }

        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }

        /* Empty States */
        .empty-state {
            grid-column: 1 / -1;
            text-align: center;
            padding: 4rem 2rem;
            color: #666;
        }

        .empty-state-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }

        .empty-state h3 {
            margin-bottom: 0.5rem;
            color: var(--text-color);
        }

        /* Advanced Features */
        .rating-stars {
            display: flex;
            gap: 2px;
        }

        .star {
            color: #ddd;
            cursor: pointer;
            transition: color 0.2s ease;
        }

        .star.filled {
            color: #ffd700;
        }

        .star:hover {
            color: #ffd700;
        }

        .version-badge {
            background: #e3f2fd;
            color: #1976d2;
            padding: 0.2rem 0.4rem;
            border-radius: 4px;
            font-size: 0.6rem;
            font-weight: 600;
        }

        .ai-suggestion {
            background: linear-gradient(135deg, #667eea20, #764ba220);
            border: 1px solid var(--primary-color);
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            position: relative;
        }

        .ai-suggestion::before {
            content: '🤖';
            position: absolute;
            top: -8px;
            left: 8px;
            background: white;
            padding: 0 0.5rem;
            font-size: 0.8rem;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                padding: 1rem 0.5rem 6rem;
            }
            
            .content-grid {
                grid-template-columns: 1fr;
                gap: 1rem;
            }

            .search-section {
                position: relative;
                top: auto;
                margin: 0.5rem 0 1rem;
                padding: 1rem;
            }

            .modal-content {
                width: 95%;
                padding: 1.5rem;
                margin: 1rem;
            }

            .fab {
                bottom: 5rem;
                right: 1rem;
                width: 56px;
                height: 56px;
                font-size: 1.3rem;
            }

            .header {
                padding: 0.75rem 1rem;
            }

            .logo {
                font-size: 1.3rem;
            }

            .btn {
                padding: 0.4rem 0.8rem;
                font-size: 0.8rem;
            }

            .card-actions {
                flex-direction: column;
                gap: 1rem;
                align-items: stretch;
            }

            .action-left, .action-right {
                justify-content: center;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 0.5rem 0.25rem 6rem;
            }

            .prompt-card {
                padding: 1rem;
            }

            .card-title {
                font-size: 1.1rem;
            }

            .filters {
                gap: 0.25rem;
            }

            .filter-tag {
                padding: 0.3rem 0.6rem;
                font-size: 0.7rem;
            }
        }

        /* Dark mode support */
        @media (prefers-color-scheme: dark) {
            :root {
                --secondary-color: #1a1a1a;
                --text-color: #e0e0e0;
                --border-color: #333;
            }

            body {
                background-color: #1a1a1a;
                color: #e0e0e0;
            }

            .prompt-card, .search-section, .modal-content {
                background: #2d2d2d;
                border-color: #444;
            }

            .prompt-preview {
                background: #222;
                color: #e0e0e0;
            }

            .form-input, .form-textarea, .form-select {
                background: #333;
                border-color: #555;
                color: #e0e0e0;
            }

            .bottom-nav {
                background: rgba(45,45,45,0.95);
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="logo">
                🚀 PromptHub
            </div>
            <div class="user-status" id="userStatus">
                <div class="sync-indicator" id="syncIndicator" title="同步狀態"></div>
                <span id="userInfo">訪客模式</span>
                <button class="btn btn-primary" onclick="toggleAuth()" id="authBtn">
                    👤 登入
                </button>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <div class="container">
        <main class="main-content">
            <!-- Search Section -->
            <section class="search-section">
                <div style="position: relative;">
                    <input type="text" class="search-input" placeholder="🔍 搜尋你的 AI Prompts..." id="searchInput">
                    <div style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); color: #999; font-size: 0.8rem;" id="searchHint">
                        Ctrl+K
                    </div>
                </div>
                <div class="filters" id="filterContainer">
                    <button class="filter-tag active" data-filter="all">全部</button>
                    <button class="filter-tag" data-filter="public">🌐 公開</button>
                    <button class="filter-tag" data-filter="private">🔒 私人</button>
                    <button class="filter-tag" data-filter="work">💼 工作</button>
                    <button class="filter-tag" data-filter="creative">🎨 創作</button>
                    <button class="filter-tag" data-filter="learning">📚 學習</button>
                    <button class="filter-tag" data-filter="premium">⭐ 精選</button>
                </div>
            </section>

            <!-- Content Grid -->
            <section class="content-grid" id="promptGrid">
                <!-- Prompt cards will be inserted here -->
            </section>
        </main>
    </div>

    <!-- Add/Edit Modal -->
    <div class="modal" id="addModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="modalTitle">新增 Prompt</h2>
                <button class="close-btn" onclick="closeModal()">&times;</button>
            </div>
            
            <form id="promptForm">
                <div class="form-group">
                    <label class="form-label">標題 *</label>
                    <input type="text" class="form-input" id="promptTitle" required placeholder="為你的 Prompt 取個好名字">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Prompt 內容 *</label>
                    <textarea class="form-textarea" id="promptContent" required placeholder="請輸入你的 prompt 內容...

範例：
你是一個專業的{角色}。請根據以下資訊：

輸入：{輸入內容}
目標：{預期目標}

要求：
- 要求1
- 要求2
- 要求3

請提供詳細且實用的回答。"></textarea>
                    <div style="font-size: 0.8rem; color: #666; margin-top: 0.5rem;">
                        💡 使用 {變數名稱} 來標記可替換的部分
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">描述</label>
                    <textarea class="form-input" id="promptDescription" placeholder="簡短描述這個 prompt 的用途、適用場景..." rows="3"></textarea>
                </div>
                
                <div class="form-group">
                    <label class="form-label">標籤（用逗號或空格分隔）</label>
                    <input type="text" class="form-input" id="promptTags" placeholder="例如：工作 創作 寫作 行銷">
                </div>
                
                <div class="form-group">
                    <label class="form-label">分類</label>
                    <select class="form-select" id="promptCategory">
                        <option value="work">💼 工作</option>
                        <option value="creative">🎨 創作</option>
                        <option value="learning">📚 學習</option>
                        <option value="coding">💻 程式開發</option>
                        <option value="business">🏢 商業</option>
                        <option value="other">📂 其他</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <div class="form-checkbox-group">
                        <input type="checkbox" class="form-checkbox" id="promptPublic">
                        <label for="promptPublic">🌐 設為公開（其他使用者可以看到和使用）</label>
                    </div>
                </div>
                
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal()">取消</button>
                    <button type="button" class="btn" onclick="saveDraft()" id="draftBtn">💾 儲存草稿</button>
                    <button type="submit" class="btn btn-success" id="submitBtn">
                        <span class="loading" style="display: none;"></span>
                        儲存
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Login Modal -->
    <div class="modal" id="loginModal">
        <div class="modal-content" style="max-width: 400px;">
            <div class="modal-header">
                <h2 class="modal-title">登入 PromptHub</h2>
                <button class="close-btn" onclick="closeLoginModal()">&times;</button>
            </div>
            
            <form id="loginForm">
                <div class="form-group">
                    <label class="form-label">電子郵件</label>
                    <input type="email" class="form-input" id="loginEmail" required placeholder="your@email.com">
                </div>
                
                <div class="form-group">
                    <label class="form-label">密碼</label>
                    <input type="password" class="form-input" id="loginPassword" required placeholder="請輸入密碼">
                </div>
                
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="showRegister()">註冊帳號</button>
                    <button type="submit" class="btn btn-success">
                        <span class="loading" style="display: none;"></span>
                        登入
                    </button>
                </div>
            </form>
            
            <div style="text-align: center; margin-top: 1rem; padding-top: 1rem; border-top: 1px solid var(--border-color); color: #666; font-size: 0.9rem;">
                🔒 你的資料將安全地同步到雲端
            </div>
        </div>
    </div>

    <!-- Export/Import Modal -->
    <div class="modal" id="dataModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">資料管理</h2>
                <button class="close-btn" onclick="closeDataModal()">&times;</button>
            </div>
            
            <div style="display: grid; gap: 1rem;">
                <div style="text-align: center; padding: 1rem; background: #f8f9fa; border-radius: 8px;">
                    <h3>匯出資料</h3>
                    <p style="color: #666; margin: 0.5rem 0;">將你的所有 Prompts 下載為備份檔案</p>
                    <button class="btn btn-primary" onclick="exportData()">
                        📥 匯出 JSON 檔案
                    </button>
                </div>
                
                <div style="text-align: center; padding: 1rem; background: #f8f9fa; border-radius: 8px;">
                    <h3>匯入資料</h3>
                    <p style="color: #666; margin: 0.5rem 0;">從備份檔案中恢復你的 Prompts</p>
                    <input type="file" id="importFile" accept=".json" style="display: none;" onchange="importData(this.files[0])">
                    <button class="btn btn-primary" onclick="document.getElementById('importFile').click()">
                        📤 選擇檔案匯入
                    </button>
                </div>
                
                <div style="text-align: center; padding: 1rem; background: #fff3cd; border-radius: 8px; border: 1px solid #ffeaa7;">
                    <h3>⚠️ 清除所有資料</h3>
                    <p style="color: #856404; margin: 0.5rem 0;">這將刪除所有本地資料，無法復原</p>
                    <button class="btn btn-danger" onclick="clearAllData()">
                        🗑️ 清除資料
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Floating Action Button -->
    <button class="fab" onclick="showAddModal()" title="快速新增 Prompt (Ctrl+N)">
        ➕
    </button>

    <!-- Bottom Navigation -->
    <nav class="bottom-nav">
        <a href="#" class="nav-item active" data-page="home">
            <div class="nav-icon">🏠</div>
            <div>首頁</div>
        </a>
        <a href="#" class="nav-item" data-page="explore">
            <div class="nav-icon">🔍</div>
            <div>探索</div>
        </a>
        <a href="#" class="nav-item" data-page="favorites">
            <div class="nav-icon">❤️</div>
            <div>收藏</div>
        </a>
        <a href="#" class="nav-item" data-page="profile">
            <div class="nav-icon">👤</div>
            <div>我的</div>
        </a>
    </nav>

    <!-- Notification -->
    <div class="notification" id="notification"></div>

    <script>
        // Application State
        let currentUser = null;
        let currentEditId = null;
        let isOnline = navigator.onLine;
        let syncQueue = [];
        
        // Sample Data with enhanced features
        let prompts = [
            {
                id: 1,
                title: "智能文案產生器",
                content: `你是一個頂尖的文案創作專家。請根據以下資訊創作一個引人注目的行銷文案：

產品/服務：{product_name}
核心特色：{key_features}
目標受眾：{target_audience}
品牌調性：{brand_tone}

創作要求：
- 文案長度：{word_count} 字以內
- 突出核心價值主張
- 運用情感化語言
- 包含明確的行動呼籲 (CTA)
- 符合品牌調性和目標受眾

請提供 3 個不同風格的文案版本供選擇。`,
                description: "專業級文案創作工具，支援多種品牌調性和目標受眾，適用於廣告、社群媒體、電商等場景",
                tags: ["行銷", "文案", "創作", "商業", "廣告", "社群"],
                category: "business",
                isPublic: true,
                author: "MarketingPro",
                authorAvatar: "M",
                likes: 342,
                comments: 28,
                views: 1567,
                bookmarks: 89,
                rating: 4.8,
                version: "2.1",
                createdAt: "2025-08-20T10:30:00Z",
                updatedAt: "2025-08-22T15:45:00Z",
                liked: false,
                bookmarked: false,
                premium: false,
                verified: true
            },
            {
                id: 2,
                title: "代碼審查助手 Pro",
                content: `作為一位資深軟體工程師和代碼審查專家，請深入分析以下程式碼：

程式語言：{language}
代碼內容：
\`\`\`{language}
{code_content}
\`\`\`

請從以下角度進行全面審查：

🔍 **代碼品質分析**
- 可讀性和維護性
- 命名規範和註解品質
- 代碼結構和組織

⚡ **效能優化建議**
- 時間複雜度和空間複雜度
- 潛在的效能瓶頸
- 優化建議和替代方案

🔒 **安全性檢查**
- 常見安全漏洞
- 輸入驗證和錯誤處理
- 最佳安全實踐

📋 **最佳實踐建議**
- 行業標準和慣例
- 設計模式應用
- 測試覆蓋建議

請提供具體、可行的改善建議和修改後的代碼範例。`,
                description: "全方位程式碼審查工具，涵蓋品質、效能、安全性和最佳實踐，支援多種程式語言",
                tags: ["程式", "審查", "開發", "品質", "安全", "優化"],
                category: "coding",
                isPublic: false,
                author: "我",
                authorAvatar: "我",
                likes: 0,
                comments: 0,
                views: 23,
                bookmarks: 1,
                rating: 5.0,
                version: "1.0",
                createdAt: "2025-08-22T09:15:00Z",
                updatedAt: "2025-08-22T09:15:00Z",
                liked: false,
                bookmarked: true,
                premium: false,
                verified: false
            },
            {
                id: 3,
                title: "AI 學習筆記整理器",
                content: `請將以下學習內容整理成結構化、易於理解和記憶的筆記：

📚 **學習主題**：{topic}
📖 **學習材料**：{source_materials}
🎯 **學習目標**：{learning_goals}
⏱️ **預計學習時間**：{time_limit}

請按照以下格式進行整理：

## 📝 核心概念
- 關鍵定義和術語
- 基本原理和框架

## 🔍 重點摘要  
- 主要知識點
- 重要公式或規則
- 關鍵案例和範例

## 💡 實際應用
- 應用場景和案例
- 實作步驟和方法

## 🧠 記憶技巧
- 助記口訣或方法
- 視覺化圖表建議

## ❓ 延伸思考
- 討論問題
- 進階學習方向

## 📚 推薦資源
- 相關書籍文章
- 線上課程或工具

## ✅ 自我檢測
- 複習問題清單
- 實踐練習建議

請確保內容簡潔明瞭，便於快速複習和長期記憶。`,
                description: "智能學習助手，將複雜知識轉化為結構化筆記，提升學習效率和記憶效果",
                tags: ["學習", "筆記", "整理", "教育", "記憶", "複習"],
                category: "learning",
                isPublic: true,
                author: "EduMaster",
                authorAvatar: "E",
                likes: 198,
                comments: 45,
                views: 892,
                bookmarks: 156,
                rating: 4.6,
                version: "1.5",
                createdAt: "2025-08-21T14:20:00Z",
                updatedAt: "2025-08-21T16:30:00Z",
                liked: false,
                bookmarked: false,
                premium: true,
                verified: true
            },
            {
                id: 4,
                title: "創意故事生成器",
                content: `你是一位富有想像力的故事創作大師。請根據以下元素創作一個引人入勝的故事：

🎭 **故事類型**：{genre}
👥 **主要角色**：{main_characters}  
🌍 **故事背景**：{setting}
🎯 **核心衝突**：{main_conflict}
💎 **關鍵元素**：{key_elements}
📏 **故事長度**：{story_length}

創作要求：
✨ 開頭要吸引讀者注意
🎢 情節發展要有起伏轉折  
💫 角色要有鮮明個性和成長
🔚 結尾要令人滿足且意猶未盡
🎨 文筆要生動有趣，富有畫面感

請先提供故事大綱，然後創作完整故事。`,
                description: "專業創意寫作工具，支援多種文體和風格，激發無限創作靈感",
                tags: ["創作", "故事", "寫作", "創意", "小說", "劇本"],
                category: "creative",
                isPublic: true,
                author: "StoryTeller",
                authorAvatar: "S",
                likes: 276,
                comments: 67,
                views: 1234,
                bookmarks: 203,
                rating: 4.9,
                version: "2.0",
                createdAt: "2025-08-19T16:45:00Z",
                updatedAt: "2025-08-20T10:12:00Z",
                liked: true,
                bookmarked: true,
                premium: true,
                verified: true
            }
        ];

        // Application Controller
        class PromptHubApp {
            constructor() {
                this.init();
            }

            init() {
                this.loadFromStorage();
                this.setupEventListeners();
                this.setupServiceWorker();
                this.renderPrompts();
                this.updateSyncStatus();
                this.showWelcomeMessage();
            }

            loadFromStorage() {
                try {
                    const savedPrompts = localStorage.getItem('prompthub_prompts');
                    const savedUser = localStorage.getItem('prompthub_user');
                    
                    if (savedPrompts) {
                        prompts = JSON.parse(savedPrompts);
                    }
                    
                    if (savedUser) {
                        currentUser = JSON.parse(savedUser);
                        this.updateUserUI();
                    }
                    
                    console.log(`✅ 載入了 ${prompts.length} 個 Prompts`);
                } catch (error) {
                    console.error('載入資料失敗:', error);
                    this.showNotification('載入資料失敗', 'error');
                }
            }

            saveToStorage() {
                try {
                    localStorage.setItem('prompthub_prompts', JSON.stringify(prompts));
                    if (currentUser) {
                        localStorage.setItem('prompthub_user', JSON.stringify(currentUser));
                    }
                    localStorage.setItem('prompthub_last_sync', Date.now().toString());
                    
                    // 模擬雲端同步
                    this.simulateCloudSync();
                } catch (error) {
                    console.error('儲存資料失敗:', error);
                    this.showNotification('儲存失敗', 'error');
                }
            }

            simulateCloudSync() {
                const indicator = document.getElementById('syncIndicator');
                indicator.className = 'sync-indicator syncing';
                
                // 模擬網路延遲
                setTimeout(() => {
                    if (isOnline) {
                        indicator.className = 'sync-indicator';
                        console.log('☁️ 已同步到雲端');
                    } else {
                        indicator.className = 'sync-indicator offline';
                        console.log('📴 離線模式 - 將在連網後同步');
                    }
                }, 1000 + Math.random() * 2000);
            }

            setupEventListeners() {
                // 搜尋功能
                const searchInput = document.getElementById('searchInput');
                let searchTimeout;
                searchInput.addEventListener('input', (e) => {
                    clearTimeout(searchTimeout);
                    searchTimeout = setTimeout(() => {
                        this.handleSearch(e.target.value);
                    }, 300);
                });

                // 篩選功能
                document.querySelectorAll('.filter-tag').forEach(tag => {
                    tag.addEventListener('click', (e) => this.handleFilter(e));
                });

                // 表單提交
                document.getElementById('promptForm').addEventListener('submit', (e) => {
                    this.handleFormSubmit(e);
                });

                document.getElementById('loginForm').addEventListener('submit', (e) => {
                    this.handleLogin(e);
                });

                // 鍵盤快捷鍵
                document.addEventListener('keydown', (e) => this.handleKeyboard(e));

                // 底部導航
                document.querySelectorAll('.nav-item').forEach(item => {
                    item.addEventListener('click', (e) => this.handleNavigation(e));
                });

                // 網路狀態監控
                window.addEventListener('online', () => this.handleOnlineStatus(true));
                window.addEventListener('offline', () => this.handleOnlineStatus(false));

                // 模態框外部點擊關閉
                document.querySelectorAll('.modal').forEach(modal => {
                    modal.addEventListener('click', (e) => {
                        if (e.target === modal) {
                            this.closeModal(modal.id);
                        }
                    });
                });
            }

            setupServiceWorker() {
                if ('serviceWorker' in navigator) {
                    // 在真實應用中，這裡會註冊 Service Worker
                    console.log('📱 PWA 功能準備就緒');
                    
                    // 模擬 PWA 安裝提示
                    setTimeout(() => {
                        if (!localStorage.getItem('pwa_install_prompted')) {
                            this.showInstallPrompt();
                        }
                    }, 5000);
                }
            }

            showInstallPrompt() {
                if (confirm('🚀 要將 PromptHub 安裝到你的裝置嗎？這樣可以更快速地存取，還支援離線使用！')) {
                    localStorage.setItem('pwa_install_prompted', 'true');
                    this.showNotification('PWA 安裝功能開發中...', 'warning');
                }
            }

            renderPrompts(filteredPrompts = prompts) {
                const grid = document.getElementById('promptGrid');
                grid.innerHTML = '';

                if (filteredPrompts.length === 0) {
                    grid.innerHTML = this.createEmptyState();
                    return;
                }

                filteredPrompts
                    .sort((a, b) => new Date(b.updatedAt) - new Date(a.updatedAt))
                    .forEach(prompt => {
                        const card = this.createPromptCard(prompt);
                        grid.appendChild(card);
                    });
            }

            createEmptyState() {
                return `
                    <div class="empty-state">
                        <div class="empty-state-icon">🔍</div>
                        <h3>沒有找到符合的 Prompts</h3>
                        <p>試試調整搜尋關鍵字或篩選條件，或者創建一個新的 Prompt！</p>
                        <button class="btn btn-primary" onclick="app.showAddModal()" style="margin-top: 1rem;">
                            ➕ 創建第一個 Prompt
                        </button>
                    </div>
                `;
            }

            createPromptCard(prompt) {
                const card = document.createElement('div');
                card.className = 'prompt-card';
                card.innerHTML = `
                    ${prompt.premium ? '<div class="meta-tag meta-premium" style="position: absolute; top: 1rem; right: 1rem;">⭐ 精選</div>' : ''}
                    
                    <div class="card-header">
                        <div style="flex: 1;">
                            <div class="card-title">${prompt.title}</div>
                            <div class="card-meta">
                                <span class="meta-tag ${prompt.isPublic ? 'meta-public' : 'meta-private'}">
                                    ${prompt.isPublic ? '🌐 公開' : '🔒 私人'}
                                </span>
                                <span class="meta-tag" style="background: #f0f0f0; color: #666;">
                                    ${this.getCategoryName(prompt.category)}
                                </span>
                                ${prompt.verified ? '<span class="meta-tag" style="background: #4caf50; color: white;">✓ 驗證</span>' : ''}
                            </div>
                            <div class="card-author">
                                <div class="author-avatar">${prompt.authorAvatar}</div>
                                <span>${prompt.author}</span>
                                <span>•</span>
                                <span>${this.formatDate(prompt.updatedAt)}</span>
                                ${prompt.version ? `<span class="version-badge">v${prompt.version}</span>` : ''}
                            </div>
                        </div>
                        <div>
                            ${prompt.author === '我' || (currentUser && prompt.author === currentUser.name) ? `
                                <button class="action-btn" onclick="app.editPrompt(${prompt.id})" title="編輯">
                                    ✏️
                                </button>
                            ` : ''}
                        </div>
                    </div>
                    
                    <div class="card-content">
                        <div class="prompt-preview" onclick="app.expandPrompt(${prompt.id})">${this.truncateText(prompt.content, 200)}</div>
                        <p class="card-description">${prompt.description}</p>
                        <div class="card-tags">
                            ${prompt.tags.map(tag => `<span class="tag" onclick="app.searchByTag('${tag}')">#${tag}</span>`).join('')}
                        </div>
                    </div>

                    <div class="card-stats">
                        <div class="stat-item">
                            <div class="rating-stars">
                                ${this.createStars(prompt.rating)}
                            </div>
                            <span>${prompt.rating}</span>
                        </div>
                        <div class="stat-item">
                            👁️ ${this.formatNumber(prompt.views)}
                        </div>
                        <div class="stat-item">
                            💬 ${prompt.comments}
                        </div>
                    </div>
                    
                    <div class="card-actions">
                        <div class="action-left">
                            <button class="action-btn ${prompt.liked ? 'liked' : ''}" onclick="app.toggleLike(${prompt.id})">
                                ${prompt.liked ? '❤️' : '🤍'} ${this.formatNumber(prompt.likes)}
                            </button>
                            <button class="action-btn ${prompt.bookmarked ? 'bookmarked' : ''}" onclick="app.toggleBookmark(${prompt.id})">
                                ${prompt.bookmarked ? '⭐' : '☆'} 
                            </button>
                            <button class="action-btn" onclick="app.showComments(${prompt.id})">
                                💬 回覆
                            </button>
                        </div>
                        <div class="action-right">
                            <button class="action-btn" onclick="app.copyPrompt(${prompt.id})" title="複製內容">
                                📋
                            </button>
                            <button class="action-btn" onclick="app.sharePrompt(${prompt.id})" title="分享">
                                📤
                            </button>
                        </div>
                    </div>
                `;
                return card;
            }

            getCategoryName(category) {
                const categories = {
                    work: '💼 工作',
                    creative: '🎨 創作',
                    learning: '📚 學習',
                    coding: '💻 程式',
                    business: '🏢 商業',
                    other: '📂 其他'
                };
                return categories[category] || '📂 其他';
            }

            formatDate(dateString) {
                const date = new Date(dateString);
                const now = new Date();
                const diff = now - date;
                const days = Math.floor(diff / (1000 * 60 * 60 * 24));
                
                if (days === 0) return '今天';
                if (days === 1) return '昨天';
                if (days < 7) return `${days} 天前`;
                if (days < 30) return `${Math.floor(days / 7)} 週前`;
                return date.toLocaleDateString('zh-TW');
            }

            formatNumber(num) {
                if (num >= 1000) {
                    return (num / 1000).toFixed(1) + 'K';
                }
                return num.toString();
            }

            createStars(rating) {
                const fullStars = Math.floor(rating);
                const hasHalfStar = rating % 1 !== 0;
                let stars = '';
                
                for (let i = 0; i < 5; i++) {
                    if (i < fullStars) {
                        stars += '<span class="star filled">⭐</span>';
                    } else if (i === fullStars && hasHalfStar) {
                        stars += '<span class="star filled">⭐</span>';
                    } else {
                        stars += '<span class="star">⭐</span>';
                    }
                }
                return stars;
            }

            truncateText(text, maxLength) {
                if (text.length <= maxLength) return text;
                return text.substring(0, maxLength) + '...';
            }

            // Event Handlers
            handleSearch(query) {
                if (!query.trim()) {
                    this.renderPrompts();
                    return;
                }

                const filtered = prompts.filter(prompt => 
                    prompt.title.toLowerCase().includes(query.toLowerCase()) ||
                    prompt.content.toLowerCase().includes(query.toLowerCase()) ||
                    prompt.description.toLowerCase().includes(query.toLowerCase()) ||
                    prompt.tags.some(tag => tag.toLowerCase().includes(query.toLowerCase())) ||
                    prompt.author.toLowerCase().includes(query.toLowerCase())
                );
                
                this.renderPrompts(filtered);
                console.log(`🔍 搜尋 "${query}" 找到 ${filtered.length} 個結果`);
            }

            handleFilter(e) {
                document.querySelectorAll('.filter-tag').forEach(tag => tag.classList.remove('active'));
                e.target.classList.add('active');
                
                const filter = e.target.dataset.filter;
                let filtered = prompts;
                
                switch (filter) {
                    case 'all':
                        filtered = prompts;
                        break;
                    case 'public':
                        filtered = prompts.filter(p => p.isPublic);
                        break;
                    case 'private':
                        filtered = prompts.filter(p => !p.isPublic);
                        break;
                    case 'premium':
                        filtered = prompts.filter(p => p.premium);
                        break;
                    default:
                        filtered = prompts.filter(p => p.category === filter);
                }
                
                this.renderPrompts(filtered);
                console.log(`📂 篩選 "${filter}" 顯示 ${filtered.length} 個 Prompts`);
            }

            handleFormSubmit(e) {
                e.preventDefault();
                
                const submitBtn = document.getElementById('submitBtn');
                const loading = submitBtn.querySelector('.loading');
                
                // 顯示載入狀態
                submitBtn.disabled = true;
                loading.style.display = 'inline-block';
                
                const formData = {
                    title: document.getElementById('promptTitle').value,
                    content: document.getElementById('promptContent').value,
                    description: document.getElementById('promptDescription').value,
                    tags: document.getElementById('promptTags').value
                        .split(/[,\s]+/)
                        .map(tag => tag.trim())
                        .filter(tag => tag),
                    category: document.getElementById('promptCategory').value,
                    isPublic: document.getElementById('promptPublic').checked
                };

                // 模擬網路延遲
                setTimeout(() => {
                    try {
                        if (currentEditId) {
                            this.updatePrompt(currentEditId, formData);
                        } else {
                            this.createPrompt(formData);
                        }
                        
                        this.closeModal('addModal');
                        this.clearDraft();
                    } catch (error) {
                        this.showNotification('儲存失敗，請重試', 'error');
                    } finally {
                        submitBtn.disabled = false;
                        loading.style.display = 'none';
                    }
                }, 1000);
            }

            handleLogin(e) {
                e.preventDefault();
                
                const email = document.getElementById('loginEmail').value;
                const password = document.getElementById('loginPassword').value;
                const submitBtn = e.target.querySelector('button[type="submit"]');
                const loading = submitBtn.querySelector('.loading');
                
                submitBtn.disabled = true;
                loading.style.display = 'inline-block';
                
                // 模擬登入過程
                setTimeout(() => {
                    // 簡單的模擬驗證
                    if (email && password) {
                        currentUser = {
                            id: Date.now(),
                            name: email.split('@')[0],
                            email: email,
                            avatar: email[0].toUpperCase(),
                            joinDate: new Date().toISOString(),
                            premium: Math.random() > 0.5 // 隨機分配會員等級
                        };
                        
                        this.updateUserUI();
                        this.saveToStorage();
                        this.closeModal('loginModal');
                        this.showNotification(`歡迎回來，${currentUser.name}！`, 'success');
                    } else {
                        this.showNotification('登入失敗，請檢查帳號密碼', 'error');
                    }
                    
                    submitBtn.disabled = false;
                    loading.style.display = 'none';
                }, 1500);
            }

            handleKeyboard(e) {
                // Ctrl/Cmd + K: 快速搜尋
                if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
                    e.preventDefault();
                    document.getElementById('searchInput').focus();
                    this.showNotification('快速搜尋已啟動 🔍');
                }
                
                // Ctrl/Cmd + N: 新增 Prompt
                if ((e.ctrlKey || e.metaKey) && e.key === 'n') {
                    e.preventDefault();
                    this.showAddModal();
                }
                
                // Escape: 關閉模態框
                if (e.key === 'Escape') {
                    this.closeAllModals();
                }
            }

            handleNavigation(e) {
                e.preventDefault();
                
                document.querySelectorAll('.nav-item').forEach(nav => nav.classList.remove('active'));
                e.currentTarget.classList.add('active');
                
                const page = e.currentTarget.dataset.page;
                
                switch (page) {
                    case 'home':
                        this.renderPrompts();
                        this.showNotification('首頁 🏠');
                        break;
                    case 'explore':
                        this.renderPrompts(prompts.filter(p => p.isPublic));
                        this.showNotification('探索公開 Prompts 🔍');
                        break;
                    case 'favorites':
                        this.renderPrompts(prompts.filter(p => p.bookmarked || p.liked));
                        this.showNotification('我的收藏 ❤️');
                        break;
                    case 'profile':
                        if (currentUser) {
                            this.renderPrompts(prompts.filter(p => p.author === currentUser.name || p.author === '我'));
                            this.showNotification('我的 Prompts 👤');
                        } else {
                            this.showLoginModal();
                        }
                        break;
                }
            }

            handleOnlineStatus(online) {
                isOnline = online;
                const indicator = document.getElementById('syncIndicator');
                
                if (online) {
                    indicator.className = 'sync-indicator';
                    this.showNotification('已重新連線，正在同步...', 'success');
                    this.processSyncQueue();
                } else {
                    indicator.className = 'sync-indicator offline';
                    this.showNotification('目前離線，資料將暫存本地', 'warning');
                }
                
                this.updateSyncStatus();
            }

            // Core Functions
            createPrompt(formData) {
                const newPrompt = {
                    id: Date.now(),
                    ...formData,
                    author: currentUser ? currentUser.name : '我',
                    authorAvatar: currentUser ? currentUser.avatar : '我',
                    likes: 0,
                    comments: 0,
                    views: 0,
                    bookmarks: 0,
                    rating: 5.0,
                    version: '1.0',
                    createdAt: new Date().toISOString(),
                    updatedAt: new Date().toISOString(),
                    liked: false,
                    bookmarked: false,
                    premium: currentUser?.premium || false,
                    verified: currentUser?.premium || false
                };

                prompts.unshift(newPrompt);
                this.saveToStorage();
                this.renderPrompts();
                this.showNotification('✨ 新 Prompt 創建成功！', 'success');
            }

            updatePrompt(id, formData) {
                const index = prompts.findIndex(p => p.id === id);
                if (index !== -1) {
                    const oldVersion = prompts[index].version || '1.0';
                    const versionParts = oldVersion.split('.').map(Number);
                    versionParts[1]++;
                    const newVersion = versionParts.join('.');

                    prompts[index] = { 
                        ...prompts[index], 
                        ...formData,
                        version: newVersion,
                        updatedAt: new Date().toISOString()
                    };
                    
                    this.saveToStorage();
                    this.renderPrompts();
                    this.showNotification('📝 Prompt 更新成功！', 'success');
                }
            }

            deletePrompt(id) {
                if (confirm('確定要刪除這個 Prompt 嗎？此操作無法復原。')) {
                    const index = prompts.findIndex(p => p.id === id);
                    if (index !== -1) {
                        prompts.splice(index, 1);
                        this.saveToStorage();
                        this.renderPrompts();
                        this.showNotification('🗑️ Prompt 已刪除', 'success');
                    }
                }
            }

            // Interactive Functions
            toggleLike(id) {
                const prompt = prompts.find(p => p.id === id);
                if (prompt) {
                    if (prompt.liked) {
                        prompt.likes = Math.max(0, prompt.likes - 1);
                        prompt.liked = false;
                    } else {
                        prompt.likes++;
                        prompt.liked = true;
                    }
                    
                    this.saveToStorage();
                    this.renderPrompts();
                    this.showNotification(prompt.liked ? '已按讚 ❤️' : '已取消按讚');
                }
            }

            toggleBookmark(id) {
                const prompt = prompts.find(p => p.id === id);
                if (prompt) {
                    prompt.bookmarked = !prompt.bookmarked;
                    if (prompt.bookmarked) {
                        prompt.bookmarks++;
                    } else {
                        prompt.bookmarks = Math.max(0, prompt.bookmarks - 1);
                    }
                    
                    this.saveToStorage();
                    this.renderPrompts();
                    this.showNotification(prompt.bookmarked ? '已收藏 ⭐' : '已取消收藏');
                }
            }

            copyPrompt(id) {
                const prompt = prompts.find(p => p.id === id);
                if (prompt) {
                    navigator.clipboard.writeText(prompt.content).then(() => {
                        // 增加檢視數
                        prompt.views++;
                        this.saveToStorage();
                        this.renderPrompts();
                        this.showNotification('📋 Prompt 已複製到剪貼板！', 'success');
                    }).catch(() => {
                        this.showNotification('複製失敗，請手動選取', 'error');
                    });
                }
            }

            sharePrompt(id) {
                const prompt = prompts.find(p => p.id === id);
                if (prompt) {
                    const shareData = {
                        title: `PromptHub - ${prompt.title}`,
                        text: prompt.description,
                        url: `${window.location.origin}?prompt=${id}`
                    };
                    
                    if (navigator.share) {
                        navigator.share(shareData);
                    } else {
                        // 備用分享方式
                        const shareText = `${prompt.title}\n\n${prompt.description}\n\n查看完整內容：${shareData.url}`;
                        navigator.clipboard.writeText(shareText);
                        this.showNotification('📤 分享連結已複製！', 'success');
                    }
                }
            }

            expandPrompt(id) {
                const prompt = prompts.find(p => p.id === id);
                if (prompt) {
                    // 增加檢視數
                    prompt.views++;
                    this.saveToStorage();
                    
                    // 顯示完整內容（可以開發獨立的檢視模態框）
                    this.showNotification('完整檢視功能開發中... 👀');
                }
            }

            searchByTag(tag) {
                document.getElementById('searchInput').value = tag;
                this.handleSearch(tag);
            }

            showComments(id) {
                this.showNotification('留言功能開發中... 💬');
            }

            // Modal Functions
            showAddModal() {
                currentEditId = null;
                document.getElementById('modalTitle').textContent = '新增 Prompt';
                document.getElementById('promptForm').reset();
                this.loadDraft();
                this.showModal('addModal');
            }

            editPrompt(id) {
                const prompt = prompts.find(p => p.id === id);
                if (!prompt) return;

                currentEditId = id;
                document.getElementById('modalTitle').textContent = '編輯 Prompt';
                document.getElementById('promptTitle').value = prompt.title;
                document.getElementById('promptContent').value = prompt.content;
                document.getElementById('promptDescription').value = prompt.description;
                document.getElementById('promptTags').value = prompt.tags.join(' ');
                document.getElementById('promptCategory').value = prompt.category;
                document.getElementById('promptPublic').checked = prompt.isPublic;
                
                this.showModal('addModal');
            }

            showLoginModal() {
                document.getElementById('loginForm').reset();
                this.showModal('loginModal');
            }

            showModal(modalId) {
                const modal = document.getElementById(modalId);
                modal.style.display = 'block';
                setTimeout(() => modal.classList.add('show'), 10);
                document.body.style.overflow = 'hidden';
            }

            closeModal(modalId) {
                const modal = document.getElementById(modalId);
                modal.classList.remove('show');
                setTimeout(() => {
                    modal.style.display = 'none';
                    document.body.style.overflow = 'auto';
                }, 300);
                
                if (modalId === 'addModal') {
                    currentEditId = null;
                }
            }

            closeAllModals() {
                document.querySelectorAll('.modal').forEach(modal => {
                    this.closeModal(modal.id);
                });
            }

            // Auth Functions
            toggleAuth() {
                if (currentUser) {
                    this.logout();
                } else {
                    this.showLoginModal();
                }
            }

            logout() {
                if (confirm('確定要登出嗎？未同步的資料可能會遺失。')) {
                    currentUser = null;
                    localStorage.removeItem('prompthub_user');
                    this.updateUserUI();
                    this.showNotification('已登出', 'success');
                }
            }

            updateUserUI() {
                const userInfo = document.getElementById('userInfo');
                const authBtn = document.getElementById('authBtn');
                
                if (currentUser) {
                    userInfo.textContent = `${currentUser.name}${currentUser.premium ? ' ⭐' : ''}`;
                    authBtn.innerHTML = '🚪 登出';
                } else {
                    userInfo.textContent = '訪客模式';
                    authBtn.innerHTML = '👤 登入';
                }
            }

            // Data Management
            saveDraft() {
                const formData = {
                    title: document.getElementById('promptTitle').value,
                    content: document.getElementById('promptContent').value,
                    description: document.getElementById('promptDescription').value,
                    tags: document.getElementById('promptTags').value,
                    category: document.getElementById('promptCategory').value,
                    isPublic: document.getElementById('promptPublic').checked
                };
                
                if (Object.values(formData).some(value => value && value.toString().trim())) {
                    localStorage.setItem('prompthub_draft', JSON.stringify(formData));
                    this.showNotification('💾 草稿已儲存');
                }
            }

            loadDraft() {
                const draft = localStorage.getItem('prompthub_draft');
                if (draft && !currentEditId) {
                    const formData = JSON.parse(draft);
                    if (confirm('發現未完成的草稿，是否要載入？')) {
                        document.getElementById('promptTitle').value = formData.title || '';
                        document.getElementById('promptContent').value = formData.content || '';
                        document.getElementById('promptDescription').value = formData.description || '';
                        document.getElementById('promptTags').value = formData.tags || '';
                        document.getElementById('promptCategory').value = formData.category || 'work';
                        document.getElementById('promptPublic').checked = formData.isPublic || false;
                    }
                }
            }

            clearDraft() {
                localStorage.removeItem('prompthub_draft');
            }

            exportData() {
                try {
                    const exportData = {
                        prompts: prompts,
                        user: currentUser,
                        exportDate: new Date().toISOString(),
                        version: '1.0'
                    };
                    
                    const dataStr = JSON.stringify(exportData, null, 2);
                    const dataBlob = new Blob([dataStr], { type: 'application/json' });
                    
                    const link = document.createElement('a');
                    link.href = URL.createObjectURL(dataBlob);
                    link.download = `prompthub_backup_${new Date().toISOString().split('T')[0]}.json`;
                    link.click();
                    
                    this.showNotification('📥 資料匯出成功！', 'success');
                } catch (error) {
                    this.showNotification('匯出失敗', 'error');
                }
            }

            importData(file) {
                if (!file) return;
                
                const reader = new FileReader();
                reader.onload = (e) => {
                    try {
                        const importedData = JSON.parse(e.target.result);
                        
                        if (importedData.prompts && Array.isArray(importedData.prompts)) {
                            // 合併資料，避免重複
                            const existingIds = new Set(prompts.map(p => p.id));
                            const newPrompts = importedData.prompts.filter(p => !existingIds.has(p.id));
                            
                            prompts = [...newPrompts, ...prompts];
                            this.saveToStorage();
                            this.renderPrompts();
                            this.showNotification(`📤 成功匯入 ${newPrompts.length} 個 Prompts！`, 'success');
                        } else {
                            this.showNotification('檔案格式不正確', 'error');
                        }
                    } catch (error) {
                        this.showNotification('匯入失敗：檔案損壞', 'error');
                    }
                };
                reader.readAsText(file);
            }

            clearAllData() {
                if (confirm('⚠️ 這將刪除所有本地資料，包括你的 Prompts、設定和草稿。此操作無法復原，確定要繼續嗎？')) {
                    if (confirm('最後確認：真的要清除所有資料嗎？建議先匯出備份。')) {
                        localStorage.clear();
                        prompts = [];
                        currentUser = null;
                        this.updateUserUI();
                        this.renderPrompts();
                        this.showNotification('🗑️ 所有資料已清除', 'warning');
                    }
                }
            }

            // Utility Functions
            updateSyncStatus() {
                const lastSync = localStorage.getItem('prompthub_last_sync');
                if (lastSync) {
                    const syncTime = new Date(parseInt(lastSync));
                    console.log(`上次同步：${syncTime.toLocaleString()}`);
                }
            }

            processSyncQueue() {
                // 處理離線時累積的操作
                if (syncQueue.length > 0) {
                    console.log(`處理 ${syncQueue.length} 個待同步操作`);
                    syncQueue = [];
                }
            }

            showNotification(message, type = 'default') {
                const notification = document.getElementById('notification');
                notification.textContent = message;
                notification.className = `notification ${type}`;
                notification.classList.add('show');
                
                setTimeout(() => {
                    notification.classList.remove('show');
                }, 3000);
            }

            showWelcomeMessage() {
                setTimeout(() => {
                    this.showNotification('🎉 歡迎使用 PromptHub！', 'success');
                }, 500);
            }
        }

        // 全域函數 (供 HTML 調用)
        let app;

        // 初始化應用程式
        document.addEventListener('DOMContentLoaded', function() {
            app = new PromptHubApp();
            
            // 自動儲存草稿
            ['promptTitle', 'promptContent', 'promptDescription', 'promptTags'].forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    element.addEventListener('input', () => {
                        clearTimeout(element.draftTimer);
                        element.draftTimer = setTimeout(() => app.saveDraft(), 1000);
                    });
                }
            });
        });

        // 全域輔助函數
        function showAddModal() { app.showAddModal(); }
        function closeModal() { app.closeAllModals(); }
        function closeLoginModal() { app.closeModal('loginModal'); }
        function closeDataModal() { app.closeModal('dataModal'); }
        function toggleAuth() { app.toggleAuth(); }
        function showRegister() { app.showNotification('註冊功能開發中...', 'warning'); }
        function saveDraft() { app.saveDraft(); }
        function exportData() { app.exportData(); }
        function importData(file) { app.importData(file); }
        function clearAllData() { app.clearAllData(); }

        // 開發者工具
        window.promptHub = {
            app: () => app,
            prompts: () => prompts,
            user: () => currentUser,
            addSampleData: () => {
                // 可以添加更多示例資料用於測試
                app.showNotification('示例資料功能可在開發階段使用');
            }
        };

        console.log('🚀 PromptHub 初始化完成！');
        console.log('💡 使用 window.promptHub 存取開發者工具');
    </script>
</body>
</html>