<div style="text-align: center; margin-top: 1rem; padding-top: 1rem; border-top: 1px solid var(--border-color); color: #666; font-size: 0.9rem;">
                ğŸ”’ ä½ çš„è³‡æ–™å°‡å®‰å…¨åœ°å„²å­˜åœ¨é›²ç«¯ï¼Œä¸¦åœ¨æ‰€æœ‰è£ç½®é–“åŒæ­¥
            </div>
        </div>
    </div>

    <!-- Add/Edit Prompt Modal -->
    <div class="modal" id="promptModal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h2 class="modal-title" id="promptModalTitle">æ–°å¢ Prompt</h2>
                <button class="close-btn" onclick="closePromptModal()">&times;</button>
            </div>
            
            <form id="promptForm">
                <div class="form-group">
                    <label class="form-label">æ¨™é¡Œ *</label>
                    <input type="text" class="form-input" id="promptTitle" required placeholder="ç‚ºä½ çš„ Prompt å–å€‹å¥½åå­—">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Prompt å…§å®¹ *</label>
                    <textarea class="form-textarea" id="promptContent" required placeholder="è«‹è¼¸å…¥ä½ çš„ prompt å…§å®¹...

ç¯„ä¾‹ï¼š
ä½ æ˜¯ä¸€å€‹å°ˆæ¥­çš„{è§’è‰²}ã€‚è«‹æ ¹æ“šä»¥ä¸‹è³‡è¨Šï¼š

è¼¸å…¥ï¼š{è¼¸å…¥å…§å®¹}
ç›®æ¨™ï¼š{é æœŸç›®æ¨™}

è¦æ±‚ï¼š
- è¦æ±‚1
- è¦æ±‚2
- è¦æ±‚3

è«‹æä¾›è©³ç´°ä¸”å¯¦ç”¨çš„å›ç­”ã€‚" style="min-height: 200px;"></textarea>
                    <div style="font-size: 0.8rem; color: #666; margin-top: 0.5rem;">
                        ğŸ’¡ ä½¿ç”¨ {è®Šæ•¸åç¨±} ä¾†æ¨™è¨˜å¯æ›¿æ›çš„éƒ¨åˆ†
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">æè¿°</label>
                    <textarea class="form-input" id="promptDescription" placeholder="ç°¡çŸ­æè¿°é€™å€‹ prompt çš„ç”¨é€”ã€é©ç”¨å ´æ™¯..." rows="3"></textarea>
                </div>
                
                <div class="form-group">
                    <label class="form-label">æ¨™ç±¤ï¼ˆç”¨ç©ºæ ¼åˆ†éš”ï¼‰</label>
                    <input type="text" class="form-input" id="promptTags" placeholder="ä¾‹å¦‚ï¼šå·¥ä½œ å‰µä½œ å¯«ä½œ è¡ŒéŠ·">
                </div>
                
                <div class="form-group">
                    <label class="form-label">åˆ†é¡</label>
                    <select class="form-select" id="promptCategory">
                        <option value="work">ğŸ’¼ å·¥ä½œ</option>
                        <option value="creative">ğŸ¨ å‰µä½œ</option>
                        <option value="learning">ğŸ“š å­¸ç¿’</option>
                        <option value="other">ğŸ“‚ å…¶ä»–</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <div class="form-checkbox-group">
                        <input type="checkbox" class="form-checkbox" id="promptPublic">
                        <label for="promptPublic">ğŸŒ è¨­ç‚ºå…¬é–‹ï¼ˆå…¶ä»–ä½¿ç”¨è€…å¯ä»¥çœ‹åˆ°å’Œä½¿ç”¨ï¼‰</label>
                    </div>
                </div>
                
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closePromptModal()">å–æ¶ˆ</button>
                    <button type="button" class="btn" onclick="saveDraft()" id="draftBtn">ğŸ’¾ å„²å­˜è‰ç¨¿</button>
                    <button type="submit" class="btn btn-success" id="promptSubmitBtn">
                        <span class="loading" style="display: none;"></span>
                        å„²å­˜
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Floating Action Button -->
    <button class="fab" onclick="showPromptModal()" title="å¿«é€Ÿæ–°å¢ Prompt (Ctrl+N)" id="fabBtn">
        â•
    </button>

    <!-- Bottom Navigation -->
    <nav class="bottom-nav">
        <a href="#" class="nav-item active" data-page="home">
            <div class="nav-icon">ğŸ </div>
            <div>é¦–é </div>
        </a>
        <a href="#" class="nav-item" data-page="explore">
            <div class="nav-icon">ğŸ”</div>
            <div>æ¢ç´¢</div>
        </a>
        <a href="#" class="nav-item" data-page="favorites">
            <div class="nav-icon">â¤ï¸</div>
            <div>æ”¶è—</div>
        </a>
        <a href="#" class="nav-item" data-page="profile">
            <div class="nav-icon">ğŸ‘¤</div>
            <div>æˆ‘çš„</div>
        </a>
    </nav>

    <!-- Notification -->
    <div class="notification" id="notification"></div>

    <!-- Load Supabase Config -->
    <script src="supabase-config.js"></script>

    <script>
        // Application State
        let currentUser = null;
        let currentEditId = null;
        let prompts = [];
        let isOnline = navigator.onLine;
        let syncInProgress = false;

        // PromptHub Application Class
        class PromptHubApp {
            constructor() {
                this.init();
            }

            async init() {
                try {
                    console.log('ğŸš€ PromptHub åˆå§‹åŒ–ä¸­...');
                    
                    // åˆå§‹åŒ– Supabase
                    const supabaseReady = await window.PromptHubSupabase.init();
                    if (!supabaseReady) {
                        throw new Error('Supabase åˆå§‹åŒ–å¤±æ•—');
                    }

                    // è¨­å®šèªè­‰ç‹€æ…‹ç›£è½
                    window.PromptHubSupabase.auth.onAuthStateChange((event, session) => {
                        this.handleAuthStateChange(event, session);
                    });

                    // æª¢æŸ¥ç•¶å‰ç”¨æˆ¶
                    await this.checkCurrentUser();

                    // è¨­å®šäº‹ä»¶ç›£è½å™¨
                    this.setupEventListeners();

                    // è¼‰å…¥åˆå§‹è³‡æ–™
                    await this.loadInitialData();

                    // æ›´æ–° UI
                    this.updateUI();

                    // è¨­å®šç¶²è·¯ç‹€æ…‹ç›£è½
                    window.addEventListener('online', () => this.handleNetworkChange(true));
                    window.addEventListener('offline', () => this.handleNetworkChange(false));

                    console.log('âœ… PromptHub åˆå§‹åŒ–å®Œæˆ');
                    this.showNotification('PromptHub å·²å°±ç·’ï¼', 'success');

                } catch (error) {
                    console.error('âŒ PromptHub åˆå§‹åŒ–å¤±æ•—:', error);
                    this.showNotification('åˆå§‹åŒ–å¤±æ•—ï¼Œå°‡ä½¿ç”¨é›¢ç·šæ¨¡å¼', 'warning');
                    this.loadLocalData();
                }
            }

            async checkCurrentUser() {
                try {
                    const result = await window.PromptHubSupabase.auth.getCurrentUser();
                    if (result.success && result.user) {
                        currentUser = result.user;
                        console.log('âœ… ç”¨æˆ¶å·²ç™»å…¥:', currentUser.email);
                    } else {
                        currentUser = null;
                        console.log('ğŸ‘¤ ç”¨æˆ¶æœªç™»å…¥');
                    }
                } catch (error) {
                    console.error('æª¢æŸ¥ç”¨æˆ¶ç‹€æ…‹å¤±æ•—:', error);
                    currentUser = null;
                }
            }

            handleAuthStateChange(event, session) {
                console.log('ğŸ”„ èªè­‰ç‹€æ…‹è®ŠåŒ–:', event);
                
                if (event === 'SIGNED_IN' && session?.user) {
                    currentUser = session.user;
                    this.showNotification('ç™»å…¥æˆåŠŸï¼', 'success');
                    this.closeAuthModal();
                    this.loadUserData();
                    this.migrateLocalDataIfNeeded();
                } else if (event === 'SIGNED_OUT') {
                    currentUser = null;
                    this.showNotification('å·²ç™»å‡º', 'success');
                    prompts = [];
                    this.loadLocalData();
                }
                
                this.updateUI();
            }

            async loadInitialData() {
                if (currentUser) {
                    await this.loadUserData();
                } else {
                    this.loadLocalData();
                }
            }

            async loadUserData() {
                try {
                    this.updateSyncStatus('syncing', 'åŒæ­¥ä¸­...');
                    
                    // è¼‰å…¥ç”¨æˆ¶çš„ prompts å’Œå…¬é–‹ prompts
                    const [userResult, publicResult] = await Promise.all([
                        window.PromptHubSupabase.prompts.getUserPrompts(currentUser.id),
                        window.PromptHubSupabase.prompts.getPublicPrompts(20)
                    ]);

                    if (userResult.success && publicResult.success) {
                        // åˆä½µç”¨æˆ¶ prompts å’Œå…¬é–‹ promptsï¼Œé¿å…é‡è¤‡
                        const userPrompts = userResult.data || [];
                        const publicPrompts = (publicResult.data || []).filter(p => 
                            p.user_id !== currentUser.id
                        );
                        
                        prompts = [...userPrompts, ...publicPrompts];
                        
                        console.log(`âœ… è¼‰å…¥äº† ${userPrompts.length} å€‹ç”¨æˆ¶ Prompts å’Œ ${publicPrompts.length} å€‹å…¬é–‹ Prompts`);
                        this.updateSyncStatus('synced', 'å·²åŒæ­¥');
                    } else {
                        throw new Error('è¼‰å…¥è³‡æ–™å¤±æ•—');
                    }
                } catch (error) {
                    console.error('âŒ è¼‰å…¥ç”¨æˆ¶è³‡æ–™å¤±æ•—:', error);
                    this.updateSyncStatus('error', 'åŒæ­¥å¤±æ•—');
                    this.loadLocalData(); // é™ç´šåˆ°æœ¬åœ°è³‡æ–™
                }
                
                this.renderPrompts();
            }

            loadLocalData() {
                try {
                    const localData = localStorage.getItem('prompthub_prompts');
                    if (localData) {
                        const localPrompts = JSON.parse(localData);
                        prompts = Array.isArray(localPrompts) ? localPrompts : [];
                        console.log(`ğŸ“± è¼‰å…¥äº† ${prompts.length} å€‹æœ¬åœ° Prompts`);
                    } else {
                        prompts = [];
                    }
                    this.updateSyncStatus('offline', 'é›¢ç·šæ¨¡å¼');
                } catch (error) {
                    console.error('è¼‰å…¥æœ¬åœ°è³‡æ–™å¤±æ•—:', error);
                    prompts = [];
                }
                
                this.renderPrompts();
            }

            async migrateLocalDataIfNeeded() {
                try {
                    const result = await window.PromptHubSupabase.migration.migrateLocalData();
                    if (result.success && result.migrated > 0) {
                        this.showNotification(`å·²å°‡ ${result.migrated} å€‹æœ¬åœ° Prompts åŒæ­¥åˆ°é›²ç«¯`, 'success');
                        await this.loadUserData();
                    }
                } catch (error) {
                    console.error('è³‡æ–™é·ç§»å¤±æ•—:', error);
                }
            }

            setupEventListeners() {
                // æœå°‹åŠŸèƒ½
                const searchInput = document.getElementById('searchInput');
                let searchTimeout;
                searchInput.addEventListener('input', (e) => {
                    clearTimeout(searchTimeout);
                    searchTimeout = setTimeout(() => {
                        this.handleSearch(e.target.value);
                    }, 300);
                });

                // ç¯©é¸åŠŸèƒ½
                document.querySelectorAll('.filter-tag').forEach(tag => {
                    tag.addEventListener('click', (e) => this.handleFilter(e));
                });

                // è¡¨å–®æäº¤
                document.getElementById('loginForm').addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.handleLogin();
                });

                document.getElementById('registerForm').addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.handleRegister();
                });

                document.getElementById('promptForm').addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.handlePromptSubmit();
                });

                // éµç›¤å¿«æ·éµ
                document.addEventListener('keydown', (e) => this.handleKeyboard(e));

                // åº•éƒ¨å°èˆª
                document.querySelectorAll('.nav-item').forEach(item => {
                    item.addEventListener('click', (e) => this.handleNavigation(e));
                });

                // æ¨¡æ…‹æ¡†å¤–éƒ¨é»æ“Šé—œé–‰
                document.querySelectorAll('.modal').forEach(modal => {
                    modal.addEventListener('click', (e) => {
                        if (e.target === modal) {
                            this.closeModal(modal.id);
                        }
                    });
                });
            }

            async handleLogin() {
                const email = document.getElementById('loginEmail').value;
                const password = document.getElementById('loginPassword').value;
                const submitBtn = document.getElementById('loginSubmitBtn');
                const loading = submitBtn.querySelector('.loading');

                if (!email || !password) {
                    this.showNotification('è«‹å¡«å¯«æ‰€æœ‰æ¬„ä½', 'error');
                    return;
                }

                try {
                    submitBtn.disabled = true;
                    loading.style.display = 'inline-block';

                    const result = await window.PromptHubSupabase.auth.signIn(email, password);
                    
                    if (!result.success) {
                        throw new Error(result.error?.message || 'ç™»å…¥å¤±æ•—');
                    }

                    // æˆåŠŸè™•ç†åœ¨ handleAuthStateChange ä¸­
                } catch (error) {
                    console.error('ç™»å…¥å¤±æ•—:', error);
                    this.showNotification('ç™»å…¥å¤±æ•—: ' + error.message, 'error');
                } finally {
                    submitBtn.disabled = false;
                    loading.style.display = 'none';
                }
            }

            async handleRegister() {
                const email = document.getElementById('registerEmail').value;
                const username = document.getElementById('registerUsername').value;
                const password = document.getElementById('registerPassword').value;
                const passwordConfirm = document.getElementById('registerPasswordConfirm').value;
                const agreeTerms = document.getElementById('agreeTerms').checked;

                const submitBtn = document.getElementById('registerSubmitBtn');
                const loading = submitBtn.querySelector('.loading');

                // é©—è­‰è¼¸å…¥
                if (!email || !username || !password || !passwordConfirm) {
                    this.showNotification('è«‹å¡«å¯«æ‰€æœ‰æ¬„ä½', 'error');
                    return;
                }

                if (password !== passwordConfirm) {
                    this.showNotification('å¯†ç¢¼ç¢ºèªä¸ä¸€è‡´', 'error');
                    return;
                }

                if (password.length < 8) {
                    this.showNotification('å¯†ç¢¼è‡³å°‘éœ€è¦ 8 å€‹å­—ç¬¦', 'error');
                    return;
                }

                if (!agreeTerms) {
                    this.showNotification('è«‹åŒæ„æœå‹™æ¢æ¬¾', 'error');
                    return;
                }

                try {
                    submitBtn.disabled = true;
                    loading.style.display = 'inline-block';

                    const result = await window.PromptHubSupabase.auth.signUp(email, password, {
                        username: username
                    });
                    
                    if (!result.success) {
                        throw new Error(result.error?.message || 'è¨»å†Šå¤±æ•—');
                    }

                    this.showNotification('è¨»å†ŠæˆåŠŸï¼è«‹æª¢æŸ¥éƒµä»¶é€²è¡Œé©—è­‰', 'success');
                    this.switchAuthTab('login');
                    
                } catch (error) {
                    console.error('è¨»å†Šå¤±æ•—:', error);
                    this.showNotification('è¨»å†Šå¤±æ•—: ' + error.message, 'error');
                } finally {
                    submitBtn.disabled = false;
                    loading.style.display = 'none';
                }
            }

            async handlePromptSubmit() {
                const title = document.getElementById('promptTitle').value;
                const content = document.getElementById('promptContent').value;
                const description = document.getElementById('promptDescription').value;
                const tags = document.getElementById('promptTags').value
                    .split(/\s+/)
                    .map(tag => tag.trim())
                    .filter(tag => tag);
                const category = document.getElementById('promptCategory').value;
                const isPublic = document.getElementById('promptPublic').checked;

                const submitBtn = document.getElementById('promptSubmitBtn');
                const loading = submitBtn.querySelector('.loading');

                if (!title || !content) {
                    this.showNotification('è«‹å¡«å¯«æ¨™é¡Œå’Œå…§å®¹', 'error');
                    return;
                }

                try {
                    submitBtn.disabled = true;
                    loading.style.display = 'inline-block';

                    const promptData = {
                        title,
                        content,
                        description,
                        category,
                        tags,
                        isPublic
                    };

                    if (currentEditId) {
                        await this.updatePrompt(currentEditId, promptData);
                    } else {
                        await this.createPrompt(promptData);
                    }

                    this.closePromptModal();
                    this.clearDraft();

                } catch (error) {
                    console.error('å„²å­˜ Prompt å¤±æ•—:', error);
                    this.showNotification('å„²å­˜å¤±æ•—ï¼Œè«‹é‡è©¦', 'error');
                } finally {
                    submitBtn.disabled = false;
                    loading.style.display = 'none';
                }
            }

            async createPrompt(promptData) {
                if (currentUser) {
                    // å„²å­˜åˆ°é›²ç«¯
                    const result = await window.PromptHubSupabase.prompts.createPrompt(promptData);
                    if (result.success) {
                        prompts.unshift(this.formatPrompt(result.data));
                        this.showNotification('âœ¨ Prompt å·²å„²å­˜åˆ°é›²ç«¯ï¼', 'success');
                    } else {
                        throw new Error(result.error?.message || 'å„²å­˜åˆ°é›²ç«¯å¤±æ•—');
                    }
                } else {
                    // å„²å­˜åˆ°æœ¬åœ°
                    const newPrompt = {
                        id: Date.now().toString(),
                        ...promptData,
                        user_id: 'local',
                        likes_count: 0,
                        views_count: 0,
                        bookmarks_count: 0,
                        created_at: new Date().toISOString(),
                        updated_at: new Date().toISOString(),
                    };

                    prompts.unshift(newPrompt);
                    this.saveLocalData();
                    this.showNotification('âœ¨ Prompt å·²å„²å­˜åˆ°æœ¬åœ°ï¼', 'success');
                }

                this.renderPrompts();
            }

            async updatePrompt(id, updates) {
                if (currentUser) {
                    const result = await window.PromptHubSupabase.prompts.updatePrompt(id, updates);
                    if (result.success) {
                        const index = prompts.findIndex(p => p.id === id);
                        if (index !== -1) {
                            prompts[index] = this.formatPrompt(result.data);
                        }
                        this.showNotification('ğŸ“ Prompt å·²æ›´æ–°ï¼', 'success');
                    } else {
                        throw new Error(result.error?.message || 'æ›´æ–°å¤±æ•—');
                    }
                } else {
                    const index = prompts.findIndex(p => p.id === id);
                    if (index !== -1) {
                        prompts[index] = {
                            ...prompts[index],
                            ...updates,
                            updated_at: new Date().toISOString()
                        };
                        this.saveLocalData();
                        this.showNotification('ğŸ“ Prompt å·²æ›´æ–°ï¼', 'success');
                    }
                }

                this.renderPrompts();
            }

            formatPrompt(rawPrompt) {
                return {
                    ...rawPrompt,
                    isPublic: rawPrompt.is_public,
                    tags: Array.isArray(rawPrompt.tags) ? rawPrompt.tags : [],
                    author: rawPrompt.user_id === currentUser?.id ? 'æˆ‘' : (rawPrompt.author || 'ç”¨æˆ¶'),
                    authorAvatar: rawPrompt.user_id === currentUser?.id ? (currentUser.email?.[0]?.toUpperCase() || 'æˆ‘') : 'ğŸ‘¤'
                };
            }

            saveLocalData() {
                try {
                    localStorage.setItem('prompthub_prompts', JSON.stringify(prompts));
                } catch (error) {
                    console.error('å„²å­˜æœ¬åœ°è³‡æ–™å¤±æ•—:', error);
                }
            }

            renderPrompts(filteredPrompts = prompts) {
                const grid = document.getElementById('promptGrid');
                grid.innerHTML = '';

                if (filteredPrompts.length === 0) {
                    grid.innerHTML = this.createEmptyState();
                    return;
                }

                filteredPrompts
                    .sort((a, b) => new Date(b.updated_at || b.created_at) - new Date(a.updated_at || a.created_at))
                    .forEach(prompt => {
                        const card = this.createPromptCard(prompt);
                        grid.appendChild(card);
                    });
            }

            createEmptyState() {
                const isUserLoggedIn = !!currentUser;
                const message = isUserLoggedIn 
                    ? 'é‚„æ²’æœ‰ Promptsï¼Œå‰µå»ºç¬¬ä¸€å€‹å§ï¼' 
                    : 'ç™»å…¥å¾Œé–‹å§‹ç®¡ç†ä½ çš„ AI Prompts';
                
                return `
                    <div class="empty-state">
                        <div class="empty-state-icon">${isUserLoggedIn ? 'ğŸ“' : 'ğŸ”'}</div>
                        <h3>${message}</h3>
                        <p>PromptHub å¹«åŠ©ä½ æœ‰æ•ˆç®¡ç†å’Œåˆ†äº« AI æç¤ºè©</p>
                        <button class="btn btn-primary" onclick="${isUserLoggedIn ? 'app.showPromptModal()' : 'app.showAuthModal()'}" style="margin-top: 1rem; background: var(--primary-gradient);">
                            ${isUserLoggedIn ? 'â• å‰µå»º Prompt' : 'ğŸ‘¤ ç«‹å³ç™»å…¥'}
                        </button>
                    </div>
                `;
            }

            createPromptCard(prompt) {
                const card = document.createElement('div');
                card.className = 'prompt-card';
                
                const isOwner = currentUser && (prompt.user_id === currentUser.id || prompt.user_id === 'local');
                const syncStatus = prompt.user_id === 'local' ? 'local' : 'synced';
                
                card.innerHTML = `
                    <div class="card-header">
                        <div style="flex: 1;">
                            <div class="card-title">${this.escapeHtml(prompt.title)}</div>
                            <div class="card-meta">
                                <span class="meta-tag ${prompt.isPublic || prompt.is_public ? 'meta-public' : 'meta-private'}">
                                    ${prompt.isPublic || prompt.is_public ? 'ğŸŒ å…¬é–‹' : 'ğŸ”’ ç§äºº'}
                                </span>
                                <span class="meta-tag meta-${syncStatus}">
                                    ${syncStatus === 'local' ? 'ğŸ“± æœ¬åœ°' : 'â˜ï¸ é›²ç«¯'}
                                </span>
                                <span class="meta-tag" style="background: #f0f0f0; color: #666;">
                                    ${this.getCategoryName(prompt.category)}
                                </span>
                            </div>
                            <div class="card-author">
                                <div class="author-avatar">${prompt.authorAvatar || prompt.author?.[0] || 'ğŸ‘¤'}</div>
                                <span>${prompt.author || 'åŒ¿åç”¨æˆ¶'}</span>
                                <span>â€¢</span>
                                <span>${this.formatDate(prompt.updated_at || prompt.created_at)}</span>
                            </div>
                        </div>
                        ${isOwner ? `
                            <div>
                                <button class="action-btn" onclick="app.editPrompt('${prompt.id}')" title="ç·¨è¼¯">
                                    âœï¸
                                </button>
                            </div>
                        ` : ''}
                    </div>
                    
                    <div class="card-content">
                        <div class="prompt-preview" onclick="app.expandPrompt('${prompt.id}')">${this.escapeHtml(this.truncateText(prompt.content, 200))}</div>
                        ${prompt.description ? `<p class="card-description">${this.escapeHtml(prompt.description)}</p>` : ''}
                        ${prompt.tags && prompt.tags.length > 0 ? `
                            <div class="card-tags">
                                ${prompt.tags.map(tag => `<span class="tag" onclick="app.searchByTag('${this.escapeHtml(tag)}')">#${this.escapeHtml(tag)}</span>`).join('')}
                            </div>
                        ` : ''}
                    </div>
                    
                    <div class="card-actions">
                        <div class="action-left">
                            <button class="action-btn" onclick="app.copyPrompt('${prompt.id}')">
                                ğŸ“‹ è¤‡è£½
                            </button>
                            <button class="action-btn" onclick="app.sharePrompt('${prompt.id}')">
                                ğŸ“¤ åˆ†äº«
                            </button>
                        </div>
                        <div class="action-right">
                            <span class="action-btn" style="cursor: default;">
                                ğŸ‘ï¸ ${prompt.views_count || 0}
                            </span>
                        </div>
                    </div>
                `;
                
                return card;
            }

            // Utility methods
            escapeHtml(unsafe) {
                return unsafe
                    .replace(/&/g, "&amp;")
                    .replace(/</g, "&lt;")
                    .replace(/>/g, "&gt;")
                    .replace(/"/g, "&quot;")
                    .replace(/'/g, "&#039;");
            }

            truncateText(text, maxLength) {
                if (!text || text.length <= maxLength) return text || '';
                return text.substring(0, maxLength) + '...';
            }

            getCategoryName(category) {
                const categories = {
                    work: 'ğŸ’¼ å·¥ä½œ',
                    creative: 'ğŸ¨ å‰µä½œ',
                    learning: 'ğŸ“š å­¸ç¿’',
                    other: 'ğŸ“‚ å…¶ä»–'
                };
                return categories[category] || 'ğŸ“‚ å…¶ä»–';
            }

            formatDate(dateString) {
                if (!dateString) return 'æœªçŸ¥æ™‚é–“';
                
                const date = new Date(dateString);
                const now = new Date();
                const diff = now - date;
                const days = Math.floor(diff / (1000 * 60 * 60 * 24));
                
                if (days === 0) return 'ä»Šå¤©';
                if (days === 1) return 'æ˜¨å¤©';
                if (days < 7) return `${days} å¤©å‰`;
                if (days < 30) return `${Math.floor(days / 7)} é€±å‰`;
                return date.toLocaleDateString('zh-TW');
            }

            // UI methods
            updateUI() {
                this.updateUserUI();
                this.updateAuthRequiredState();
                this.updateFabVisibility();
            }

            updateUserUI() {
                const userDisplayName = document.getElementById('userDisplayName');
                const userAvatar = document.getElementById('userAvatar');
                const userInitial = document.getElementById('userInitial');
                const authBtn = document.getElementById('authBtn');

                if (currentUser) {
                    const displayName = currentUser.user_metadata?.username || currentUser.email.split('@')[0];
                    const initial = displayName[0].toUpperCase();
                    
                    userDisplayName.textContent = displayName;
                    userInitial.textContent = initial;
                    userAvatar.style.display = 'flex';
                    authBtn.innerHTML = 'ğŸšª ç™»å‡º';
                    authBtn.onclick = () => this.handleLogout();
                } else {
                    userDisplayName.textContent = 'è¨ªå®¢æ¨¡å¼';
                    userAvatar.style.display = 'none';
                    authBtn.innerHTML = 'ğŸ‘¤ ç™»å…¥';
                    authBtn.onclick = () => this.showAuthModal();
                }
            }

            updateAuthRequiredState() {
                const authRequired = document.getElementById('authRequired');
                const searchSection = document.getElementById('searchSection');
                
                if (!currentUser && prompts.length === 0) {
                    authRequired.style.display = 'block';
                    searchSection.style.display = 'none';
                } else {
                    authRequired.style.display = 'none';
                    searchSection.style.display = 'block';
                }
            }

            updateFabVisibility() {
                const fab = document.getElementById('fabBtn');
                // FAB å§‹çµ‚é¡¯ç¤ºï¼Œæœªç™»å…¥ç”¨æˆ¶é»æ“Šæ™‚æœƒæç¤ºç™»å…¥
                fab.style.display = 'flex';
            }

            updateSyncStatus(status, message) {
                const syncIndicator = document.getElementById('syncIndicator');
                const syncStatus = document.getElementById('syncStatus');
                
                syncIndicator.className = `sync-indicator ${status}`;
                syncStatus.textContent = message;
            }

            // Modal methods
            showAuthModal() {
                const modal = document.getElementById('authModal');
                modal.classList.add('show');
                document.body.style.overflow = 'hidden';
            }

            closeAuthModal() {
                const modal = document.getElementById('authModal');
                modal.classList.remove('show');
                document.body.style.overflow = 'auto';
                
                // æ¸…ç©ºè¡¨å–®
                document.getElementById('loginForm').reset();
                document.getElementById('registerForm').reset();
            }

            showPromptModal() {
                if (!currentUser) {
                    this.showAuthModal();
                    this.showNotification('è«‹å…ˆç™»å…¥ä»¥ä½¿ç”¨å®Œæ•´åŠŸèƒ½', 'warning');
                    return;
                }

                currentEditId = null;
                document.getElementById('promptModalTitle').textContent = 'æ–°å¢ Prompt';
                document.getElementById('promptForm').reset();
                this.loadDraft();
                
                const modal = document.getElementById('promptModal');
                modal.classList.add('show');
                document.body.style.overflow = 'hidden';
            }

            closePromptModal() {
                const modal = document.getElementById('promptModal');
                modal.classList.remove('show');
                document.body.style.overflow = 'auto';
                currentEditId = null;
            }

            switchAuthTab(tabName) {
                // æ›´æ–°æ¨™ç±¤ç‹€æ…‹
                document.querySelectorAll('.auth-tab').forEach(tab => {
                    tab.classList.remove('active');
                });
                document.querySelector(`[onclick="switchAuthTab('${tabName}')"]`).classList.add('active');

                // åˆ‡æ›è¡¨å–®
                document.querySelectorAll('.auth-form').forEach(form => {
                    form.classList.remove('active');
                });
                document.getElementById(`${tabName}Form`).classList.add('active');
            }

            // Event handlers
            handleSearch(query) {
                if (!query.trim()) {
                    this.renderPrompts();
                    return;
                }

                const filtered = prompts.filter(prompt => 
                    prompt.title.toLowerCase().includes(query.toLowerCase()) ||
                    prompt.content.toLowerCase().includes(query.toLowerCase()) ||
                    (prompt.description || '').toLowerCase().includes(query.toLowerCase()) ||
                    (prompt.tags || []).some(tag => tag.toLowerCase().includes(query.toLowerCase()))
                );
                
                this.renderPrompts(filtered);
                console.log(`ğŸ” æœå°‹ "${query}" æ‰¾åˆ° ${filtered.length} å€‹çµæœ`);
            }

            handleFilter(e) {
                document.querySelectorAll('.filter-tag').forEach(tag => tag.classList.remove('active'));
                e.target.classList.add('active');
                
                const filter = e.target.dataset.filter;
                let filtered = prompts;
                
                switch (filter) {
                    case 'all':
                        filtered = prompts;
                        break;
                    case 'public':
                        filtered = prompts.filter(p => p.isPublic || p.is_public);
                        break;
                    case 'private':
                        filtered = prompts.filter(p => !(p.isPublic || p.is_public));
                        break;
                    default:
                        filtered = prompts.filter(p => p.category === filter);
                }
                
                this.renderPrompts(filtered);
                console.log(`ğŸ“‚ ç¯©é¸ "${filter}" é¡¯ç¤º ${filtered.length} å€‹ Prompts`);
            }

            handleKeyboard(e) {
                // Ctrl/Cmd + K: å¿«é€Ÿæœå°‹
                if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
                    e.preventDefault();
                    document.getElementById('searchInput').focus();
                    this.showNotification('å¿«é€Ÿæœå°‹å·²å•Ÿå‹• ğŸ”');
                }
                
                // Ctrl/Cmd + N: æ–°å¢ Prompt
                if ((e.ctrlKey || e.metaKey) && e.key === 'n') {
                    e.preventDefault();
                    this.showPromptModal();
                }
                
                // Escape: é—œé–‰æ¨¡æ…‹æ¡†
                if (e.key === 'Escape') {
                    this.closeAllModals();
                }
            }

            handleNavigation(e) {
                e.preventDefault();
                
                document.querySelectorAll('.nav-item').forEach(nav => nav.classList.remove('active'));
                e.currentTarget.classList.add('active');
                
                const page = e.currentTarget.dataset.page;
                
                switch (page) {
                    case 'home':
                        this.renderPrompts();
                        this.showNotification('é¦–é  ğŸ ');
                        break;
                    case 'explore':
                        const publicPrompts = prompts.filter(p => p.isPublic || p.is_public);
                        this.renderPrompts(publicPrompts);
                        this.showNotification('æ¢ç´¢å…¬é–‹ Prompts ğŸ”');
                        break;
                    case 'favorites':
                        const favoritePrompts = prompts.filter(p => p.bookmarked || p.liked);
                        this.renderPrompts(favoritePrompts);
                        this.showNotification('æˆ‘çš„æ”¶è— â¤ï¸');
                        break;
                    case 'profile':
                        if (currentUser) {
                            const userPrompts = prompts.filter(p => 
                                p.user_id === currentUser.id || p.user_id === 'local'
                            );
                            this.renderPrompts(userPrompts);
                            this.showNotification('æˆ‘çš„ Prompts ğŸ‘¤');
                        } else {
                            this.showAuthModal();
                            this.showNotification('è«‹å…ˆç™»å…¥', 'warning');
                        }
                        break;
                }
            }

            handleNetworkChange(online) {
                isOnline = online;
                
                if (online) {
                    this.showNotification('å·²é‡æ–°é€£ç·š', 'success');
                    if (currentUser) {
                        this.loadUserData();
                    }
                } else {
                    this.updateSyncStatus('offline', 'é›¢ç·šæ¨¡å¼');
                    this.showNotification('ç›®å‰é›¢ç·šï¼Œè³‡æ–™å°‡æš«å­˜æœ¬åœ°', 'warning');
                }
            }

            async handleLogout() {
                if (confirm('ç¢ºå®šè¦ç™»å‡ºå—ï¼Ÿ')) {
                    try {
                        await window.PromptHubSupabase.auth.signOut();
                    } catch (error) {
                        console.error('ç™»å‡ºå¤±æ•—:', error);
                        this.showNotification('ç™»å‡ºå¤±æ•—', 'error');
                    }
                }
            }

            // Prompt actions
            editPrompt(id) {
                const prompt = prompts.find(p => p.id === id);
                if (!prompt) return;

                // æª¢æŸ¥æ¬Šé™
                if (!currentUser || (prompt.user_id !== currentUser.id && prompt.user_id !== 'local')) {
                    this.showNotification('åªèƒ½ç·¨è¼¯è‡ªå·±çš„ Prompts', 'error');
                    return;
                }

                currentEditId = id;
                document.getElementById('promptModalTitle').textContent = 'ç·¨è¼¯ Prompt';
                document.getElementById('promptTitle').value = prompt.title;
                document.getElementById('promptContent').value = prompt.content;
                document.getElementById('promptDescription').value = prompt.description || '';
                document.getElementById('promptTags').value = (prompt.tags || []).join(' ');
                document.getElementById('promptCategory').value = prompt.category || 'other';
                document.getElementById('promptPublic').checked = prompt.isPublic || prompt.is_public || false;
                
                const modal = document.getElementById('promptModal');
                modal.classList.add('show');
                document.body.style.overflow = 'hidden';
            }

            copyPrompt(id) {
                const prompt = prompts.find(p => p.id === id);
                if (prompt) {
                    navigator.clipboard.writeText(prompt.content).then(() => {
                        this.showNotification('ğŸ“‹ Prompt å·²è¤‡è£½åˆ°å‰ªè²¼æ¿ï¼', 'success');
                    }).catch(() => {
                        this.showNotification('è¤‡è£½å¤±æ•—ï¼Œè«‹æ‰‹å‹•é¸å–', 'error');
                    });
                }
            }

            sharePrompt(id) {
                const prompt = prompts.find(p => p.id === id);
                if (prompt) {
                    const shareData = {
                        title: `PromptHub - ${prompt.title}`,
                        text: prompt.description || 'æŸ¥çœ‹é€™å€‹å¯¦ç”¨çš„ AI Prompt',
                        url: window.location.href
                    };
                    
                    if (navigator.share) {
                        navigator.share(shareData);
                    } else {
                        const shareText = `${prompt.title}\n\n${prompt.description || ''}\n\næŸ¥çœ‹æ›´å¤šï¼š${shareData.url}`;
                        navigator.clipboard.writeText(shareText);
                        this.showNotification('ğŸ“¤ åˆ†äº«é€£çµå·²è¤‡è£½ï¼', 'success');
                    }
                }
            }

            expandPrompt(id) {
                const prompt = prompts.find(p => p.id === id);
                if (prompt) {
                    // ç°¡å–®å±•é–‹åŠŸèƒ½ï¼Œé¡¯ç¤ºå®Œæ•´å…§å®¹
                    alert(`${prompt.title}\n\n${prompt.content}`);
                }
            }

            searchByTag(tag) {
                document.getElementById('searchInput').value = tag;
                this.handleSearch(tag);
            }

            // Draft management
            saveDraft() {
                const formData = {
                    title: document.getElementById('promptTitle').value,
                    content: document.getElementById('promptContent').value,
                    description: document.getElementById('promptDescription').value,
                    tags: document.getElementById('promptTags').value,
                    category: document.getElementById('promptCategory').value,
                    isPublic: document.getElementById('promptPublic').checked
                };
                
                if (Object.values(formData).some(value => value && value.toString().trim())) {
                    localStorage.setItem('prompthub_draft', JSON.stringify(formData));
                    this.showNotification('ğŸ’¾ è‰ç¨¿å·²å„²å­˜');
                }
            }

            loadDraft() {
                const draft = localStorage.getItem('prompthub_draft');
                if (draft && !currentEditId) {
                    const formData = JSON.parse(draft);
                    if (confirm('ç™¼ç¾æœªå®Œæˆçš„è‰ç¨¿ï¼Œæ˜¯å¦è¦è¼‰å…¥ï¼Ÿ')) {
                        document.getElementById('promptTitle').value = formData.title || '';
                        document.getElementById('promptContent').value = formData.content || '';
                        document.getElementById('promptDescription').value = formData.description || '';
                        document.getElementById('promptTags').value = formData.tags || '';
                        document.getElementById('promptCategory').value = formData.category || 'other';
                        document.getElementById('promptPublic').checked = formData.isPublic || false;
                    }
                }
            }

            clearDraft() {
                localStorage.removeItem('prompthub_draft');
            }

            // Utility methods
            closeAllModals() {
                document.querySelectorAll('.modal').forEach(modal => {
                    modal.classList.remove('show');
                });
                document.body.style.overflow = 'auto';
                currentEditId = null;
            }

            closeModal(modalId) {
                const modal = document.getElementById(modalId);
                modal.classList.remove('show');
                document.body.style.overflow = 'auto';
                
                if (modalId === 'promptModal') {
                    currentEditId = null;
                }
            }

            showNotification(message, type = 'default') {
                const notification = document.getElementById('notification');
                notification.textContent = message;
                notification.className = `notification ${type}`;
                notification.classList.add('show');
                
                setTimeout(() => {
                    notification.classList.remove('show');
                }, 3000);
            }
        }

        // Global functions for HTML onclick handlers
        let app;

        // åˆå§‹åŒ–æ‡‰ç”¨ç¨‹å¼
        document.addEventListener('DOMContentLoaded', function() {
            app = new PromptHubApp();
            
            // è‡ªå‹•å„²å­˜è‰ç¨¿
            ['promptTitle', 'promptContent', 'promptDescription', 'promptTags'].forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    element.addEventListener('input', () => {
                        clearTimeout(element.draftTimer);
                        element.draftTimer = setTimeout(() => app.saveDraft(), 2000);
                    });
                }
            });
        });

        // Global helper functions
        function toggleAuth() { app.toggleAuth(); }
        function showAuthModal() { app.showAuthModal(); }
        function closeAuthModal() { app.closeAuthModal(); }
        function showPromptModal() { app.showPromptModal(); }
        function closePromptModal() { app.closePromptModal(); }
        function switchAuthTab(tab) { app.switchAuthTab(tab); }
        function showForgotPassword() { 
            app.showNotification('å¯†ç¢¼é‡è¨­åŠŸèƒ½é–‹ç™¼ä¸­...', 'warning'); 
        }
        function saveDraft() { app.saveDraft(); }

        // éŒ¯èª¤è™•ç†
        window.addEventListener('error', (event) => {
            console.error('å…¨åŸŸéŒ¯èª¤:', event.error);
            if (app) {
                app.showNotification('ç™¼ç”ŸéŒ¯èª¤ï¼Œè«‹é‡æ–°æ•´ç†é é¢', 'error');
            }
        });

        window.addEventListener('unhandledrejection', (event) => {
            console.error('æœªè™•ç†çš„ Promise éŒ¯èª¤:', event.reason);
            if (app) {
                app.showNotification('ç¶²è·¯éŒ¯èª¤ï¼Œè«‹æª¢æŸ¥é€£ç·š', 'error');
            }
        });

        console.log('ğŸš€ PromptHub å·²æº–å‚™å°±ç·’ï¼');
    </script>
</body>
</html><!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PromptHub - AI Prompt ç®¡ç†å¹³å°</title>
    
    <!-- PWA Meta tags -->
    <meta name="description" content="å°ˆæ¥­çš„ AI Prompt ç®¡ç†å¹³å°ï¼Œæ”¯æ´é›²ç«¯åŒæ­¥ã€ç¤¾ç¾¤åˆ†äº«">
    <meta name="theme-color" content="#667eea">
    
    <style>
        :root {
            --primary-color: #667eea;
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --secondary-color: #f8f9fa;
            --text-color: #333;
            --border-color: #e9ecef;
            --shadow-light: 0 2px 10px rgba(0,0,0,0.08);
            --shadow-medium: 0 4px 20px rgba(0,0,0,0.15);
            --border-radius: 12px;
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: var(--secondary-color);
            color: var(--text-color);
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* Header Styles */
        .header {
            background: var(--primary-gradient);
            color: white;
            padding: 1rem;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: var(--shadow-medium);
            backdrop-filter: blur(10px);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1200px;
            margin: 0 auto;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 1rem;
            font-size: 0.9rem;
        }

        .sync-status {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .sync-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #4caf50;
            animation: pulse 2s infinite;
        }

        .sync-indicator.syncing {
            background: #ff9800;
        }

        .sync-indicator.error {
            background: #f44336;
        }

        .sync-indicator.offline {
            background: #9e9e9e;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .user-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: rgba(255,255,255,0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        /* Button Styles */
        .btn {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-family: inherit;
            text-decoration: none;
        }

        .btn-primary {
            background: rgba(255,255,255,0.2);
            color: white;
            backdrop-filter: blur(10px);
        }

        .btn-primary:hover {
            background: rgba(255,255,255,0.3);
            transform: translateY(-1px);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-success {
            background: #28a745;
            color: white;
        }

        .btn-danger {
            background: #dc3545;
            color: white;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-medium);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        /* Loading States */
        .loading {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Container and Layout */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 1rem;
            min-height: calc(100vh - 200px);
        }

        /* Auth States */
        .auth-required {
            text-align: center;
            padding: 4rem 2rem;
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-light);
            margin: 2rem 0;
        }

        .auth-required h2 {
            margin-bottom: 1rem;
            color: var(--text-color);
        }

        .auth-required p {
            color: #666;
            margin-bottom: 2rem;
        }

        /* Search and Filter Styles */
        .search-section {
            background: white;
            border-radius: var(--border-radius);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: var(--shadow-light);
            position: sticky;
            top: 80px;
            z-index: 50;
        }

        .search-input {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            font-size: 1rem;
            transition: var(--transition);
            background: rgba(255,255,255,0.9);
        }

        .search-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .filters {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
            flex-wrap: wrap;
        }

        .filter-tag {
            padding: 0.4rem 1rem;
            background: var(--border-color);
            border: none;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: var(--transition);
            font-family: inherit;
        }

        .filter-tag.active {
            background: var(--primary-color);
            color: white;
        }

        .filter-tag:hover {
            transform: translateY(-1px);
        }

        /* Content Grid */
        .content-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        /* Prompt Card Styles */
        .prompt-card {
            background: white;
            border-radius: var(--border-radius);
            padding: 1.5rem;
            box-shadow: var(--shadow-light);
            transition: var(--transition);
            border: 2px solid transparent;
            position: relative;
            overflow: hidden;
        }

        .prompt-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--primary-gradient);
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }

        .prompt-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-medium);
            border-color: var(--primary-color);
        }

        .prompt-card:hover::before {
            transform: scaleX(1);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }

        .card-title {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--text-color);
            margin-bottom: 0.5rem;
            line-height: 1.3;
        }

        .card-meta {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
            margin-bottom: 0.5rem;
        }

        .meta-tag {
            padding: 0.2rem 0.6rem;
            border-radius: 15px;
            font-size: 0.7rem;
            font-weight: 500;
        }

        .meta-public {
            background: #e3f2fd;
            color: #1976d2;
        }

        .meta-private {
            background: #fff3e0;
            color: #f57c00;
        }

        .meta-synced {
            background: #e8f5e8;
            color: #4caf50;
        }

        .meta-local {
            background: #f3e5f5;
            color: #9c27b0;
        }

        .card-author {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.8rem;
            color: #666;
            margin-bottom: 0.5rem;
        }

        .author-avatar {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: var(--primary-gradient);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            font-weight: bold;
        }

        .card-content {
            margin: 1rem 0;
        }

        .prompt-preview {
            background: #f8f9fa;
            padding: 1rem;
            border-radius: 8px;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 0.85rem;
            border-left: 4px solid var(--primary-color);
            margin-bottom: 1rem;
            max-height: 150px;
            overflow: hidden;
            position: relative;
            line-height: 1.5;
        }

        .prompt-preview::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 30px;
            background: linear-gradient(transparent, #f8f9fa);
            pointer-events: none;
        }

        .card-description {
            color: #666;
            font-size: 0.9rem;
            margin-bottom: 1rem;
            line-height: 1.5;
        }

        .card-tags {
            display: flex;
            gap: 0.3rem;
            flex-wrap: wrap;
            margin-bottom: 1rem;
        }

        .tag {
            padding: 0.2rem 0.6rem;
            background: var(--border-color);
            border-radius: 12px;
            font-size: 0.7rem;
            color: #666;
            transition: var(--transition);
        }

        .tag:hover {
            background: var(--primary-color);
            color: white;
            cursor: pointer;
        }

        .card-actions {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid var(--border-color);
        }

        .action-left, .action-right {
            display: flex;
            gap: 0.5rem;
        }

        .action-btn {
            display: flex;
            align-items: center;
            gap: 0.3rem;
            background: none;
            border: none;
            color: #666;
            cursor: pointer;
            font-size: 0.8rem;
            padding: 0.4rem 0.6rem;
            border-radius: 6px;
            transition: var(--transition);
            font-family: inherit;
        }

        .action-btn:hover {
            color: var(--primary-color);
            background: rgba(102, 126, 234, 0.1);
            transform: translateY(-1px);
        }

        .action-btn.liked {
            color: #e74c3c;
        }

        .action-btn.bookmarked {
            color: #f39c12;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            backdrop-filter: blur(5px);
            z-index: 1000;
            animation: fadeIn 0.3s ease;
        }

        .modal.show {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: white;
            border-radius: var(--border-radius);
            padding: 2rem;
            width: 90%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
            animation: slideUp 0.3s ease;
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideUp {
            from { 
                opacity: 0; 
                transform: translateY(50px); 
            }
            to { 
                opacity: 1; 
                transform: translateY(0); 
            }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid var(--border-color);
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--text-color);
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #999;
            padding: 0.25rem;
            border-radius: 4px;
            transition: var(--transition);
        }

        .close-btn:hover {
            color: var(--text-color);
            background: var(--border-color);
        }

        /* Form Styles */
        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: var(--text-color);
        }

        .form-input, .form-textarea, .form-select {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            font-size: 1rem;
            transition: var(--transition);
            font-family: inherit;
            background: white;
        }

        .form-textarea {
            min-height: 120px;
            resize: vertical;
            font-family: 'Monaco', 'Menlo', monospace;
            line-height: 1.5;
        }

        .form-input:focus, .form-textarea:focus, .form-select:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .form-checkbox-group {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .form-checkbox {
            width: auto;
            margin: 0;
        }

        .form-actions {
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
            margin-top: 2rem;
            padding-top: 1rem;
            border-top: 2px solid var(--border-color);
        }

        /* Auth Forms */
        .auth-tabs {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            border-bottom: 2px solid var(--border-color);
        }

        .auth-tab {
            padding: 0.75rem 1rem;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
            color: #666;
            border-bottom: 2px solid transparent;
            transition: var(--transition);
        }

        .auth-tab.active {
            color: var(--primary-color);
            border-bottom-color: var(--primary-color);
        }

        .auth-form {
            display: none;
        }

        .auth-form.active {
            display: block;
        }

        /* FAB */
        .fab {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            width: 64px;
            height: 64px;
            background: var(--primary-gradient);
            border: none;
            border-radius: 50%;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 0 8px 24px rgba(102, 126, 234, 0.4);
            transition: var(--transition);
            z-index: 50;
        }

        .fab:hover {
            transform: scale(1.1) translateY(-2px);
            box-shadow: 0 12px 32px rgba(102, 126, 234, 0.6);
        }

        .fab:active {
            transform: scale(0.95);
        }

        /* Bottom Navigation */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(10px);
            border-top: 1px solid var(--border-color);
            padding: 0.5rem;
            display: flex;
            justify-content: space-around;
            z-index: 100;
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 0.5rem;
            color: #666;
            text-decoration: none;
            font-size: 0.7rem;
            transition: var(--transition);
            border-radius: 8px;
            position: relative;
        }

        .nav-item.active {
            color: var(--primary-color);
            background: rgba(102, 126, 234, 0.1);
        }

        .nav-icon {
            font-size: 1.2rem;
            margin-bottom: 0.2rem;
        }

        /* Notification */
        .notification {
            position: fixed;
            top: 2rem;
            right: 2rem;
            background: var(--primary-gradient);
            color: white;
            padding: 1rem 1.5rem;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-medium);
            transform: translateX(400px);
            transition: transform 0.3s ease;
            z-index: 1100;
            max-width: 300px;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.success {
            background: linear-gradient(135deg, #4caf50, #45a049);
        }

        .notification.error {
            background: linear-gradient(135deg, #f44336, #d32f2f);
        }

        .notification.warning {
            background: linear-gradient(135deg, #ff9800, #f57c00);
        }

        /* Empty States */
        .empty-state {
            grid-column: 1 / -1;
            text-align: center;
            padding: 4rem 2rem;
            color: #666;
        }

        .empty-state-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }

        .empty-state h3 {
            margin-bottom: 0.5rem;
            color: var(--text-color);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                padding: 1rem 0.5rem 6rem;
            }
            
            .content-grid {
                grid-template-columns: 1fr;
                gap: 1rem;
            }

            .search-section {
                position: relative;
                top: auto;
                margin: 0.5rem 0 1rem;
                padding: 1rem;
            }

            .modal-content {
                width: 95%;
                padding: 1.5rem;
                margin: 1rem;
            }

            .fab {
                bottom: 5rem;
                right: 1rem;
                width: 56px;
                height: 56px;
                font-size: 1.3rem;
            }

            .header {
                padding: 0.75rem 1rem;
            }

            .logo {
                font-size: 1.3rem;
            }

            .user-info {
                gap: 0.5rem;
                font-size: 0.8rem;
            }

            .card-actions {
                flex-direction: column;
                gap: 1rem;
                align-items: stretch;
            }

            .action-left, .action-right {
                justify-content: center;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 0.5rem 0.25rem 6rem;
            }

            .prompt-card {
                padding: 1rem;
            }

            .card-title {
                font-size: 1.1rem;
            }

            .filters {
                gap: 0.25rem;
            }

            .filter-tag {
                padding: 0.3rem 0.6rem;
                font-size: 0.7rem;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="logo">
                ğŸš€ PromptHub
            </div>
            <div class="user-info" id="userInfo">
                <div class="sync-status">
                    <div class="sync-indicator" id="syncIndicator" title="åŒæ­¥ç‹€æ…‹"></div>
                    <span id="syncStatus">é€£æ¥ä¸­...</span>
                </div>
                <div class="user-avatar" id="userAvatar" style="display: none;">
                    <span id="userInitial"></span>
                </div>
                <span id="userDisplayName">è¨ªå®¢æ¨¡å¼</span>
                <button class="btn btn-primary" onclick="toggleAuth()" id="authBtn">
                    ğŸ‘¤ ç™»å…¥
                </button>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <div class="container">
        <main class="main-content">
            <!-- Auth Required State -->
            <div class="auth-required" id="authRequired" style="display: none;">
                <div class="empty-state-icon">ğŸ”</div>
                <h2>æ­¡è¿ä½¿ç”¨ PromptHub</h2>
                <p>ç™»å…¥å¾Œå³å¯äº«å—é›²ç«¯åŒæ­¥ã€å¤šè£ç½®å­˜å–ç­‰å®Œæ•´åŠŸèƒ½</p>
                <button class="btn btn-primary" onclick="showAuthModal()" style="background: var(--primary-gradient); padding: 1rem 2rem;">
                    ç«‹å³ç™»å…¥/è¨»å†Š
                </button>
            </div>

            <!-- Search Section -->
            <section class="search-section" id="searchSection">
                <div style="position: relative;">
                    <input type="text" class="search-input" placeholder="ğŸ” æœå°‹ä½ çš„ AI Prompts..." id="searchInput">
                    <div style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); color: #999; font-size: 0.8rem;" id="searchHint">
                        Ctrl+K
                    </div>
                </div>
                <div class="filters" id="filterContainer">
                    <button class="filter-tag active" data-filter="all">å…¨éƒ¨</button>
                    <button class="filter-tag" data-filter="public">ğŸŒ å…¬é–‹</button>
                    <button class="filter-tag" data-filter="private">ğŸ”’ ç§äºº</button>
                    <button class="filter-tag" data-filter="work">ğŸ’¼ å·¥ä½œ</button>
                    <button class="filter-tag" data-filter="creative">ğŸ¨ å‰µä½œ</button>
                    <button class="filter-tag" data-filter="learning">ğŸ“š å­¸ç¿’</button>
                    <button class="filter-tag" data-filter="other">ğŸ“‚ å…¶ä»–</button>
                </div>
            </section>

            <!-- Content Grid -->
            <section class="content-grid" id="promptGrid">
                <!-- Prompt cards will be inserted here -->
            </section>
        </main>
    </div>

    <!-- Auth Modal -->
    <div class="modal" id="authModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">åŠ å…¥ PromptHub</h2>
                <button class="close-btn" onclick="closeAuthModal()">&times;</button>
            </div>
            
            <div class="auth-tabs">
                <button class="auth-tab active" onclick="switchAuthTab('login')">ç™»å…¥</button>
                <button class="auth-tab" onclick="switchAuthTab('register')">è¨»å†Š</button>
            </div>

            <!-- Login Form -->
            <form class="auth-form active" id="loginForm">
                <div class="form-group">
                    <label class="form-label">é›»å­éƒµä»¶</label>
                    <input type="email" class="form-input" id="loginEmail" required placeholder="your@email.com">
                </div>
                
                <div class="form-group">
                    <label class="form-label">å¯†ç¢¼</label>
                    <input type="password" class="form-input" id="loginPassword" required placeholder="è«‹è¼¸å…¥å¯†ç¢¼">
                </div>
                
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="showForgotPassword()">å¿˜è¨˜å¯†ç¢¼ï¼Ÿ</button>
                    <button type="submit" class="btn btn-success" id="loginSubmitBtn">
                        <span class="loading" style="display: none;"></span>
                        ç™»å…¥
                    </button>
                </div>
            </form>

            <!-- Register Form -->
            <form class="auth-form" id="registerForm">
                <div class="form-group">
                    <label class="form-label">é›»å­éƒµä»¶</label>
                    <input type="email" class="form-input" id="registerEmail" required placeholder="your@email.com">
                </div>

                <div class="form-group">
                    <label class="form-label">ç”¨æˆ¶åç¨±</label>
                    <input type="text" class="form-input" id="registerUsername" required placeholder="é¸æ“‡ä¸€å€‹ç”¨æˆ¶åç¨±">
                </div>
                
                <div class="form-group">
                    <label class="form-label">å¯†ç¢¼</label>
                    <input type="password" class="form-input" id="registerPassword" required placeholder="è‡³å°‘ 8 å€‹å­—ç¬¦">
                </div>

                <div class="form-group">
                    <label class="form-label">ç¢ºèªå¯†ç¢¼</label>
                    <input type="password" class="form-input" id="registerPasswordConfirm" required placeholder="å†æ¬¡è¼¸å…¥å¯†ç¢¼">
                </div>
                
                <div class="form-group">
                    <div class="form-checkbox-group">
                        <input type="checkbox" class="form-checkbox" id="agreeTerms" required>
                        <label for="agreeTerms">æˆ‘åŒæ„æœå‹™æ¢æ¬¾å’Œéš±ç§æ”¿ç­–</label>
                    </div>
                </div>
                
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeAuthModal()">å–æ¶ˆ</button>
                    <button type="submit" class="btn btn-success" id="registerSubmitBtn">
                        <span class="loading" style="display: none;"></span>
                        è¨»å†Š
                    </button>
                </div>
            </form>
            
            <div style="text-align
